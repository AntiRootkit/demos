
Microsoft (R) Windows Debugger Version 10.0.15063.0 AMD64
Copyright (c) Microsoft Corporation. All rights reserved.

Waiting for pipe \\.\pipe\dbg
Waiting to reconnect...
Connected to Windows 7 7601 x86 compatible target at (Sat Sep 23 18:05:04.210 2017 (UTC - 7:00)), ptr64 FALSE
Kernel Debugger connection established.
Symbol search path is: srv*
Executable search path is: 
Windows 7 Kernel Version 7601 MP (1 procs) Free x86 compatible
Built by: 7601.17514.x86fre.win7sp1_rtm.101119-1850
Machine Name:
Kernel base = 0x8263d000 PsLoadedModuleList = 0x82787850
System Uptime: not available

*** Fatal System Error: 0x00000050
                       (0x95ED6000,0x00000000,0x82676B90,0x00000000)

Break instruction exception - code 80000003 (first chance)

A fatal system error has occurred.
Debugger entered on first try; Bugcheck callbacks have not been invoked.

A fatal system error has occurred.

Connected to Windows 7 7601 x86 compatible target at (Sat Sep 23 18:12:48.593 2017 (UTC - 7:00)), ptr64 FALSE
Loading Kernel Symbols
...............................................................
.....................................

Press ctrl-c (cdb, kd, ntsd) or ctrl-break (windbg) to abort symbol loads that take too long.
Run !sym noisy before .reload to track down problems loading symbols.

...........................
....
Loading User Symbols

Loading unloaded module list
......Unable to enumerate user-mode unloaded modules, Win32 error 0n30
*******************************************************************************
*                                                                             *
*                        Bugcheck Analysis                                    *
*                                                                             *
*******************************************************************************

Use !analyze -v to get detailed debugging information.

BugCheck 50, {95ed6000, 0, 82676b90, 0}

Debugger extension ext.Analyze execution is cancelled.
      PC: bed39e08  VA: 6b67d828  R/W: 7  Parameter: 6b67d9a0
nt!RtlpBreakWithStatusInstruction:
826b8110 cc              int     3
kd> !analyze -v
*******************************************************************************
*                                                                             *
*                        Bugcheck Analysis                                    *
*                                                                             *
*******************************************************************************

PAGE_FAULT_IN_NONPAGED_AREA (50)
Invalid system memory was referenced.  This cannot be protected by try-except.
Typically the address is just plain bad or it is pointing at freed memory.
Arguments:
Arg1: 95ed6000, memory referenced.
Arg2: 00000000, value 0 = read operation, 1 = write operation.
Arg3: 82676b90, If non-zero, the instruction address which referenced the bad memory
	address.
Arg4: 00000000, (reserved)

Debugging Details:
------------------


DUMP_CLASS: 1

DUMP_QUALIFIER: 0

BUILD_VERSION_STRING:  6.1.7601.17514 (win7sp1_rtm.101119-1850)

DUMP_TYPE:  0

BUGCHECK_P1: ffffffff95ed6000

BUGCHECK_P2: 0

BUGCHECK_P3: ffffffff82676b90

BUGCHECK_P4: 0

READ_ADDRESS:  95ed6000 Paged pool

FAULTING_IP: 
nt!memmove+90
82676b90 f3a5            rep movs dword ptr es:[edi],dword ptr [esi]

MM_INTERNAL_CODE:  0

CPU_COUNT: 1

CPU_MHZ: 6a0

CPU_VENDOR:  GenuineIntel

CPU_FAMILY: 6

CPU_MODEL: 3a

CPU_STEPPING: 9

CPU_MICROCODE: 6,3a,9,0 (F,M,S,R)  SIG: FFFFFFFF'00000000 (cache) FFFFFFFF'00000000 (init)

DEFAULT_BUCKET_ID:  WIN7_DRIVER_FAULT

BUGCHECK_STR:  0x50

PROCESS_NAME:  System

CURRENT_IRQL:  2

ANALYSIS_SESSION_HOST:  DESKTOP-LRP1ELD

ANALYSIS_SESSION_TIME:  09-23-2017 18:13:11.0921

ANALYSIS_VERSION: 10.0.15063.0 amd64fre

TRAP_FRAME:  88af6ab4 -- (.trap 0xffffffff88af6ab4)
ErrCode = 00000000
eax=00000042 ebx=83fc801d ecx=00001f3a edx=00000001 esi=95ed6000 edi=83fccf34
eip=82676b90 esp=88af6b28 ebp=88af6b30 iopl=0         nv up ei pl nz na po nc
cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00010202
nt!memmove+0x90:
82676b90 f3a5            rep movs dword ptr es:[edi],dword ptr [esi]
Resetting default scope

LAST_CONTROL_TRANSFER:  from 8271c083 to 826b8110

STACK_TEXT:  
88af65fc 8271c083 00000003 012648da 00000065 nt!RtlpBreakWithStatusInstruction
88af664c 8271cb81 00000003 83f28020 0000188c nt!KiBugCheckDebugBreak+0x1c
88af6a10 826cb41b 00000050 95ed6000 00000000 nt!KeBugCheck2+0x68b
88af6a9c 8267e3d8 00000000 95ed6000 00000000 nt!MmAccessFault+0x106
88af6a9c 82676b90 00000000 95ed6000 00000000 nt!KiTrap0E+0xdc
88af6b30 9169027e 83fc801d 95ed10e9 0000cc00 nt!memmove+0x90
88af6b5c 91690603 83fc8014 95ed10e4 83e7a008 srv!SrvOs2FeaToNt+0x53
88af6b7c 916a9602 83fc8014 88af6bbc 88af6ba8 srv!SrvOs2FeaListToNt+0x9e
88af6bb4 916b1149 83fbc008 82676b00 95ec5008 srv!SrvSmbOpen2+0x93
88af6bc8 916b21b8 9167f6ec 83e7a008 91681000 srv!ExecuteTransaction+0x101
88af6c00 9167b496 83e7a008 8549c058 8549c020 srv!SrvSmbTransactionSecondary+0x2c5
88af6c28 9168a922 00000000 83f28020 00000000 srv!SrvProcessSmb+0x187
88af6c50 82846f5e 0049c020 01264206 00000000 srv!WorkerThread+0x15c
88af6c90 826ee219 9168a7c6 8549c020 00000000 nt!PspSystemThreadStartup+0x9e
00000000 00000000 00000000 00000000 00000000 nt!KiThreadStartup+0x19


STACK_COMMAND:  kb

THREAD_SHA1_HASH_MOD_FUNC:  a9a8a5399299b8ebff890a7643f1e60a855071d2

THREAD_SHA1_HASH_MOD_FUNC_OFFSET:  72c38b8bbeeb3a062f92b9ccac0806d4fd5fafd4

THREAD_SHA1_HASH_MOD:  ac1a5d1a39094b9b6459217748c8fe13b5876638

FOLLOWUP_IP: 
srv!SrvOs2FeaToNt+53
9169027e 0fb74606        movzx   eax,word ptr [esi+6]

FAULT_INSTR_CODE:  646b70f

SYMBOL_STACK_INDEX:  6

SYMBOL_NAME:  srv!SrvOs2FeaToNt+53

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: srv

IMAGE_NAME:  srv.sys

DEBUG_FLR_IMAGE_TIMESTAMP:  4ce78aa9

FAILURE_BUCKET_ID:  0x50_srv!SrvOs2FeaToNt+53

BUCKET_ID:  0x50_srv!SrvOs2FeaToNt+53

PRIMARY_PROBLEM_CLASS:  0x50_srv!SrvOs2FeaToNt+53

TARGET_TIME:  2017-09-24T01:12:47.000Z

OSBUILD:  7601

OSSERVICEPACK:  17514

SERVICEPACK_NUMBER: 0

OS_REVISION: 0

SUITE_MASK:  272

PRODUCT_TYPE:  1

OSPLATFORM_TYPE:  x86

OSNAME:  Windows 7

OSEDITION:  Windows 7 WinNt TerminalServer SingleUserTS

OS_LOCALE:  

USER_LCID:  0

OSBUILD_TIMESTAMP:  2010-11-20 00:42:49

BUILDDATESTAMP_STR:  101119-1850

BUILDLAB_STR:  win7sp1_rtm

BUILDOSVER_STR:  6.1.7601.17514

ANALYSIS_SESSION_ELAPSED_TIME:  ee4

ANALYSIS_SOURCE:  KM

FAILURE_ID_HASH_STRING:  km:0x50_srv!srvos2featont+53

FAILURE_ID_HASH:  {f71acc46-b439-a0c9-4a90-99bdfd57cdf4}

Followup:     MachineOwner
---------

kd> kv
 # ChildEBP RetAddr  Args to Child              
00 88af65fc 8271c083 00000003 012648da 00000065 nt!RtlpBreakWithStatusInstruction (FPO: [1,0,0])
01 88af664c 8271cb81 00000003 83f28020 0000188c nt!KiBugCheckDebugBreak+0x1c
02 88af6a10 826cb41b 00000050 95ed6000 00000000 nt!KeBugCheck2+0x68b
03 88af6a9c 8267e3d8 00000000 95ed6000 00000000 nt!MmAccessFault+0x106
04 88af6a9c 82676b90 00000000 95ed6000 00000000 nt!KiTrap0E+0xdc (FPO: [0,0] TrapFrame @ 88af6ab4)
05 88af6b30 9169027e 83fc801d 95ed10e9 0000cc00 nt!memmove+0x90
06 88af6b5c 91690603 83fc8014 95ed10e4 83e7a008 srv!SrvOs2FeaToNt+0x53 (FPO: [Non-Fpo])
07 88af6b7c 916a9602 83fc8014 88af6bbc 88af6ba8 srv!SrvOs2FeaListToNt+0x9e (FPO: [Non-Fpo])
08 88af6bb4 916b1149 83fbc008 82676b00 95ec5008 srv!SrvSmbOpen2+0x93 (FPO: [Non-Fpo])
09 88af6bc8 916b21b8 9167f6ec 83e7a008 91681000 srv!ExecuteTransaction+0x101 (FPO: [0,0,4])
0a 88af6c00 9167b496 83e7a008 8549c058 8549c020 srv!SrvSmbTransactionSecondary+0x2c5 (FPO: [Non-Fpo])
0b 88af6c28 9168a922 00000000 83f28020 00000000 srv!SrvProcessSmb+0x187 (FPO: [Non-Fpo])
0c 88af6c50 82846f5e 0049c020 01264206 00000000 srv!WorkerThread+0x15c (FPO: [Non-Fpo])
0d 88af6c90 826ee219 9168a7c6 8549c020 00000000 nt!PspSystemThreadStartup+0x9e
0e 00000000 00000000 00000000 00000000 00000000 nt!KiThreadStartup+0x19
kd> uf srv!SrvOs2FeaToNt+0x53
srv!SrvOs2FeaToNt:
9169022b 8bff            mov     edi,edi
9169022d 55              push    ebp
9169022e 8bec            mov     ebp,esp
91690230 53              push    ebx
91690231 56              push    esi
91690232 8b7508          mov     esi,dword ptr [ebp+8]
91690235 57              push    edi
91690236 8b7d0c          mov     edi,dword ptr [ebp+0Ch]
91690239 8a07            mov     al,byte ptr [edi]
9169023b 884604          mov     byte ptr [esi+4],al
9169023e 8a4701          mov     al,byte ptr [edi+1]
91690241 884605          mov     byte ptr [esi+5],al
91690244 668b4702        mov     ax,word ptr [edi+2]
91690248 66894606        mov     word ptr [esi+6],ax
9169024c 0fb64701        movzx   eax,byte ptr [edi+1]
91690250 50              push    eax
91690251 8d4704          lea     eax,[edi+4]
91690254 50              push    eax
91690255 8d5e08          lea     ebx,[esi+8]
91690258 53              push    ebx
91690259 ff15e0f06791    call    dword ptr [srv!_imp__memmove (9167f0e0)]
9169025f 0fb64605        movzx   eax,byte ptr [esi+5]
91690263 03d8            add     ebx,eax
91690265 c60300          mov     byte ptr [ebx],0
91690268 0fb74606        movzx   eax,word ptr [esi+6]
9169026c 50              push    eax
9169026d 0fb64605        movzx   eax,byte ptr [esi+5]
91690271 8d443805        lea     eax,[eax+edi+5]
91690275 50              push    eax
91690276 43              inc     ebx
91690277 53              push    ebx
91690278 ff15e0f06791    call    dword ptr [srv!_imp__memmove (9167f0e0)]
9169027e 0fb74606        movzx   eax,word ptr [esi+6]
91690282 8d441803        lea     eax,[eax+ebx+3]
91690286 83e0fc          and     eax,0FFFFFFFCh
91690289 83c418          add     esp,18h
9169028c 8bc8            mov     ecx,eax
9169028e 2bce            sub     ecx,esi
91690290 5f              pop     edi
91690291 890e            mov     dword ptr [esi],ecx
91690293 5e              pop     esi
91690294 5b              pop     ebx
91690295 5d              pop     ebp
91690296 c20800          ret     8
kd> uf srv!SrvOs2FeaListToNt+0x9e
srv!SrvOs2FeaListToNt:
91690565 8bff            mov     edi,edi
91690567 55              push    ebp
91690568 8bec            mov     ebp,esp
9169056a 51              push    ecx
9169056b 8365fc00        and     dword ptr [ebp-4],0
9169056f 56              push    esi
91690570 57              push    edi
91690571 8b7d08          mov     edi,dword ptr [ebp+8]
91690574 57              push    edi
91690575 e82effffff      call    srv!SrvOs2FeaListSizeToNt (916904a8)
9169057a 8b7510          mov     esi,dword ptr [ebp+10h]
9169057d 8906            mov     dword ptr [esi],eax
9169057f 85c0            test    eax,eax
91690581 7510            jne     srv!SrvOs2FeaListToNt+0x2e (91690593)  Branch

srv!SrvOs2FeaListToNt+0x1e:
91690583 8b4d14          mov     ecx,dword ptr [ebp+14h]
91690586 668901          mov     word ptr [ecx],ax
91690589 b8fff098c0      mov     eax,0C098F0FFh
9169058e e9c0000000      jmp     srv!SrvOs2FeaListToNt+0xee (91690653)  Branch

srv!SrvOs2FeaListToNt+0x2e:
91690593 6a15            push    15h
91690595 5a              pop     edx
91690596 8bc8            mov     ecx,eax
91690598 e85125feff      call    srv!SrvAllocateNonPagedPool (91672aee)
9169059d 8b4d0c          mov     ecx,dword ptr [ebp+0Ch]
916905a0 8901            mov     dword ptr [ecx],eax
916905a2 85c0            test    eax,eax
916905a4 753d            jne     srv!SrvOs2FeaListToNt+0x7e (916905e3)  Branch

srv!SrvOs2FeaListToNt+0x41:
916905a6 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916905ab 80781d02        cmp     byte ptr [eax+1Dh],2
916905af 722b            jb      srv!SrvOs2FeaListToNt+0x77 (916905dc)  Branch

srv!SrvOs2FeaListToNt+0x4c:
916905b1 f6402001        test    byte ptr [eax+20h],1
916905b5 7425            je      srv!SrvOs2FeaListToNt+0x77 (916905dc)  Branch

srv!SrvOs2FeaListToNt+0x52:
916905b7 ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916905bd 3c02            cmp     al,2
916905bf 731b            jae     srv!SrvOs2FeaListToNt+0x77 (916905dc)  Branch

srv!SrvOs2FeaListToNt+0x5c:
916905c1 6a00            push    0
916905c3 ff36            push    dword ptr [esi]
916905c5 6842416891      push    offset srv! ?? ::NNGAKEGL::`string' (91684142)
916905ca e8c0d7feff      call    srv!DbgPrint (9167dd8f)
916905cf 68b2386891      push    offset srv! ?? ::NNGAKEGL::`string' (916838b2)
916905d4 e8b6d7feff      call    srv!DbgPrint (9167dd8f)
916905d9 83c410          add     esp,10h

srv!SrvOs2FeaListToNt+0x77:
916905dc b8050200c0      mov     eax,0C0000205h
916905e1 eb70            jmp     srv!SrvOs2FeaListToNt+0xee (91690653)  Branch

srv!SrvOs2FeaListToNt+0x7e:
916905e3 8b0f            mov     ecx,dword ptr [edi]
916905e5 53              push    ebx
916905e6 8d5c39fb        lea     ebx,[ecx+edi-5]
916905ea 8d7704          lea     esi,[edi+4]
916905ed 3bf3            cmp     esi,ebx
916905ef 7727            ja      srv!SrvOs2FeaListToNt+0xb3 (91690618)  Branch

srv!SrvOs2FeaListToNt+0x8c:
916905f1 f6067f          test    byte ptr [esi],7Fh
916905f4 753c            jne     srv!SrvOs2FeaListToNt+0xcd (91690632)  Branch

srv!SrvOs2FeaListToNt+0x91:
916905f6 56              push    esi
916905f7 50              push    eax
916905f8 894508          mov     dword ptr [ebp+8],eax
916905fb 8975fc          mov     dword ptr [ebp-4],esi
916905fe e828fcffff      call    srv!SrvOs2FeaToNt (9169022b)
91690603 0fb65601        movzx   edx,byte ptr [esi+1]
91690607 0fb74e02        movzx   ecx,word ptr [esi+2]
9169060b 03d6            add     edx,esi
9169060d 8d740a05        lea     esi,[edx+ecx+5]
91690611 3bf3            cmp     esi,ebx
91690613 76dc            jbe     srv!SrvOs2FeaListToNt+0x8c (916905f1)  Branch

srv!SrvOs2FeaListToNt+0xb0:
91690615 8b4508          mov     eax,dword ptr [ebp+8]

srv!SrvOs2FeaListToNt+0xb3:
91690618 8b0f            mov     ecx,dword ptr [edi]
9169061a 03cf            add     ecx,edi
9169061c 3bf1            cmp     esi,ecx
9169061e 742d            je      srv!SrvOs2FeaListToNt+0xe8 (9169064d)  Branch

srv!SrvOs2FeaListToNt+0xbb:
91690620 8b45fc          mov     eax,dword ptr [ebp-4]
91690623 8b4d14          mov     ecx,dword ptr [ebp+14h]
91690626 2bc7            sub     eax,edi
91690628 668901          mov     word ptr [ecx],ax
9169062b be010000c0      mov     esi,0C0000001h
91690630 eb0d            jmp     srv!SrvOs2FeaListToNt+0xda (9169063f)  Branch

srv!SrvOs2FeaListToNt+0xcd:
91690632 8b4514          mov     eax,dword ptr [ebp+14h]
91690635 2bf7            sub     esi,edi
91690637 668930          mov     word ptr [eax],si
9169063a be0d0000c0      mov     esi,0C000000Dh

srv!SrvOs2FeaListToNt+0xda:
9169063f 8b450c          mov     eax,dword ptr [ebp+0Ch]
91690642 8b08            mov     ecx,dword ptr [eax]
91690644 e84f24feff      call    srv!SrvFreeNonPagedPool (91672a98)
91690649 8bc6            mov     eax,esi
9169064b eb05            jmp     srv!SrvOs2FeaListToNt+0xed (91690652)  Branch

srv!SrvOs2FeaListToNt+0xe8:
9169064d 832000          and     dword ptr [eax],0
91690650 33c0            xor     eax,eax

srv!SrvOs2FeaListToNt+0xed:
91690652 5b              pop     ebx

srv!SrvOs2FeaListToNt+0xee:
91690653 5f              pop     edi
91690654 5e              pop     esi
91690655 c9              leave
91690656 c21000          ret     10h
kd> uf srv!SrvOs2FeaListToNt+0x9e
srv!SrvOs2FeaListToNt:
91690565 8bff            mov     edi,edi
91690567 55              push    ebp
91690568 8bec            mov     ebp,esp
9169056a 51              push    ecx
9169056b 8365fc00        and     dword ptr [ebp-4],0
9169056f 56              push    esi
91690570 57              push    edi
91690571 8b7d08          mov     edi,dword ptr [ebp+8]
91690574 57              push    edi
91690575 e82effffff      call    srv!SrvOs2FeaListSizeToNt (916904a8)
9169057a 8b7510          mov     esi,dword ptr [ebp+10h]
9169057d 8906            mov     dword ptr [esi],eax
9169057f 85c0            test    eax,eax
91690581 7510            jne     srv!SrvOs2FeaListToNt+0x2e (91690593)  Branch

srv!SrvOs2FeaListToNt+0x1e:
91690583 8b4d14          mov     ecx,dword ptr [ebp+14h]
91690586 668901          mov     word ptr [ecx],ax
91690589 b8fff098c0      mov     eax,0C098F0FFh
9169058e e9c0000000      jmp     srv!SrvOs2FeaListToNt+0xee (91690653)  Branch

srv!SrvOs2FeaListToNt+0x2e:
91690593 6a15            push    15h
91690595 5a              pop     edx
91690596 8bc8            mov     ecx,eax
91690598 e85125feff      call    srv!SrvAllocateNonPagedPool (91672aee)
9169059d 8b4d0c          mov     ecx,dword ptr [ebp+0Ch]
916905a0 8901            mov     dword ptr [ecx],eax
916905a2 85c0            test    eax,eax
916905a4 753d            jne     srv!SrvOs2FeaListToNt+0x7e (916905e3)  Branch

srv!SrvOs2FeaListToNt+0x41:
916905a6 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916905ab 80781d02        cmp     byte ptr [eax+1Dh],2
916905af 722b            jb      srv!SrvOs2FeaListToNt+0x77 (916905dc)  Branch

srv!SrvOs2FeaListToNt+0x4c:
916905b1 f6402001        test    byte ptr [eax+20h],1
916905b5 7425            je      srv!SrvOs2FeaListToNt+0x77 (916905dc)  Branch

srv!SrvOs2FeaListToNt+0x52:
916905b7 ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916905bd 3c02            cmp     al,2
916905bf 731b            jae     srv!SrvOs2FeaListToNt+0x77 (916905dc)  Branch

srv!SrvOs2FeaListToNt+0x5c:
916905c1 6a00            push    0
916905c3 ff36            push    dword ptr [esi]
916905c5 6842416891      push    offset srv! ?? ::NNGAKEGL::`string' (91684142)
916905ca e8c0d7feff      call    srv!DbgPrint (9167dd8f)
916905cf 68b2386891      push    offset srv! ?? ::NNGAKEGL::`string' (916838b2)
916905d4 e8b6d7feff      call    srv!DbgPrint (9167dd8f)
916905d9 83c410          add     esp,10h

srv!SrvOs2FeaListToNt+0x77:
916905dc b8050200c0      mov     eax,0C0000205h
916905e1 eb70            jmp     srv!SrvOs2FeaListToNt+0xee (91690653)  Branch

srv!SrvOs2FeaListToNt+0x7e:
916905e3 8b0f            mov     ecx,dword ptr [edi]
916905e5 53              push    ebx
916905e6 8d5c39fb        lea     ebx,[ecx+edi-5]
916905ea 8d7704          lea     esi,[edi+4]
916905ed 3bf3            cmp     esi,ebx
916905ef 7727            ja      srv!SrvOs2FeaListToNt+0xb3 (91690618)  Branch

srv!SrvOs2FeaListToNt+0x8c:
916905f1 f6067f          test    byte ptr [esi],7Fh
916905f4 753c            jne     srv!SrvOs2FeaListToNt+0xcd (91690632)  Branch

srv!SrvOs2FeaListToNt+0x91:
916905f6 56              push    esi
916905f7 50              push    eax
916905f8 894508          mov     dword ptr [ebp+8],eax
916905fb 8975fc          mov     dword ptr [ebp-4],esi
916905fe e828fcffff      call    srv!SrvOs2FeaToNt (9169022b)
91690603 0fb65601        movzx   edx,byte ptr [esi+1]
91690607 0fb74e02        movzx   ecx,word ptr [esi+2]
9169060b 03d6            add     edx,esi
9169060d 8d740a05        lea     esi,[edx+ecx+5]
91690611 3bf3            cmp     esi,ebx
91690613 76dc            jbe     srv!SrvOs2FeaListToNt+0x8c (916905f1)  Branch

srv!SrvOs2FeaListToNt+0xb0:
91690615 8b4508          mov     eax,dword ptr [ebp+8]

srv!SrvOs2FeaListToNt+0xb3:
91690618 8b0f            mov     ecx,dword ptr [edi]
9169061a 03cf            add     ecx,edi
9169061c 3bf1            cmp     esi,ecx
9169061e 742d            je      srv!SrvOs2FeaListToNt+0xe8 (9169064d)  Branch

srv!SrvOs2FeaListToNt+0xbb:
91690620 8b45fc          mov     eax,dword ptr [ebp-4]
91690623 8b4d14          mov     ecx,dword ptr [ebp+14h]
91690626 2bc7            sub     eax,edi
91690628 668901          mov     word ptr [ecx],ax
9169062b be010000c0      mov     esi,0C0000001h
91690630 eb0d            jmp     srv!SrvOs2FeaListToNt+0xda (9169063f)  Branch

srv!SrvOs2FeaListToNt+0xcd:
91690632 8b4514          mov     eax,dword ptr [ebp+14h]
91690635 2bf7            sub     esi,edi
91690637 668930          mov     word ptr [eax],si
9169063a be0d0000c0      mov     esi,0C000000Dh

srv!SrvOs2FeaListToNt+0xda:
9169063f 8b450c          mov     eax,dword ptr [ebp+0Ch]
91690642 8b08            mov     ecx,dword ptr [eax]
91690644 e84f24feff      call    srv!SrvFreeNonPagedPool (91672a98)
91690649 8bc6            mov     eax,esi
9169064b eb05            jmp     srv!SrvOs2FeaListToNt+0xed (91690652)  Branch

srv!SrvOs2FeaListToNt+0xe8:
9169064d 832000          and     dword ptr [eax],0
91690650 33c0            xor     eax,eax

srv!SrvOs2FeaListToNt+0xed:
91690652 5b              pop     ebx

srv!SrvOs2FeaListToNt+0xee:
91690653 5f              pop     edi
91690654 5e              pop     esi
91690655 c9              leave
91690656 c21000          ret     10h
kd> uf srv!ExecuteTransaction+0x101
srv!ExecuteTransaction:
916b1048 8bff            mov     edi,edi
916b104a 53              push    ebx
916b104b 56              push    esi
916b104c 57              push    edi
916b104d 8bf9            mov     edi,ecx
916b104f 8a878c000000    mov     al,byte ptr [edi+8Ch]
916b1055 8bb7a0000000    mov     esi,dword ptr [edi+0A0h]
916b105b 884620          mov     byte ptr [esi+20h],al
916b105e 8a878c000000    mov     al,byte ptr [edi+8Ch]
916b1064 6a02            push    2
916b1066 5b              pop     ebx
916b1067 3c25            cmp     al,25h
916b1069 7404            je      srv!ExecuteTransaction+0x27 (916b106f)  Branch

srv!ExecuteTransaction+0x23:
916b106b 3c26            cmp     al,26h
916b106d 753f            jne     srv!ExecuteTransaction+0x66 (916b10ae)  Branch

srv!ExecuteTransaction+0x27:
916b106f 80be9500000000  cmp     byte ptr [esi+95h],0
916b1076 7436            je      srv!ExecuteTransaction+0x66 (916b10ae)  Branch

srv!ExecuteTransaction+0x30:
916b1078 807f1500        cmp     byte ptr [edi+15h],0
916b107c 7530            jne     srv!ExecuteTransaction+0x66 (916b10ae)  Branch

srv!ExecuteTransaction+0x36:
916b107e b201            mov     dl,1
916b1080 c7471848106b91  mov     dword ptr [edi+18h],offset srv!ExecuteTransaction (916b1048)
916b1087 e813c9fcff      call    srv!SrvQueueWorkToLpcThread (9167d99f)
916b108c 85c0            test    eax,eax
916b108e 0f8dca030000    jge     srv!ExecuteTransaction+0x416 (916b145e)  Branch

srv!ExecuteTransaction+0x4c:
916b1094 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b1099 689a000000      push    9Ah
916b109e 6a00            push    0
916b10a0 50              push    eax
916b10a1 57              push    edi
916b10a2 e833490000      call    srv!_SrvSetSmbError2 (916b59da)
916b10a7 6a02            push    2
916b10a9 e9b2030000      jmp     srv!ExecuteTransaction+0x418 (916b1460)  Branch

srv!ExecuteTransaction+0x66:
916b10ae 8b5778          mov     edx,dword ptr [edi+78h]
916b10b1 8b4f7c          mov     ecx,dword ptr [edi+7Ch]
916b10b4 3ca0            cmp     al,0A0h
916b10b6 7409            je      srv!ExecuteTransaction+0x79 (916b10c1)  Branch

srv!ExecuteTransaction+0x70:
916b10b8 3ca1            cmp     al,0A1h
916b10ba 7405            je      srv!ExecuteTransaction+0x79 (916b10c1)  Branch

srv!ExecuteTransaction+0x74:
916b10bc 83c115          add     ecx,15h
916b10bf eb03            jmp     srv!ExecuteTransaction+0x7c (916b10c4)  Branch

srv!ExecuteTransaction+0x79:
916b10c1 83c125          add     ecx,25h

srv!ExecuteTransaction+0x7c:
916b10c4 837e4400        cmp     dword ptr [esi+44h],0
916b10c8 894e3c          mov     dword ptr [esi+3Ch],ecx
916b10cb 7513            jne     srv!ExecuteTransaction+0x98 (916b10e0)  Branch

srv!ExecuteTransaction+0x85:
916b10cd 8b4654          mov     eax,dword ptr [esi+54h]
916b10d0 03c0            add     eax,eax
916b10d2 2bc2            sub     eax,edx
916b10d4 8d440803        lea     eax,[eax+ecx+3]
916b10d8 83e0fc          and     eax,0FFFFFFFCh
916b10db 03c2            add     eax,edx
916b10dd 894644          mov     dword ptr [esi+44h],eax

srv!ExecuteTransaction+0x98:
916b10e0 837e4c00        cmp     dword ptr [esi+4Ch],0
916b10e4 7514            jne     srv!ExecuteTransaction+0xb2 (916b10fa)  Branch

srv!ExecuteTransaction+0x9e:
916b10e6 8b4660          mov     eax,dword ptr [esi+60h]
916b10e9 8b4e44          mov     ecx,dword ptr [esi+44h]
916b10ec 2bc2            sub     eax,edx
916b10ee 8d440803        lea     eax,[eax+ecx+3]
916b10f2 83e0fc          and     eax,0FFFFFFFCh
916b10f5 03c2            add     eax,edx
916b10f7 89464c          mov     dword ptr [esi+4Ch],eax

srv!ExecuteTransaction+0xb2:
916b10fa 8a878c000000    mov     al,byte ptr [edi+8Ch]
916b1100 3c25            cmp     al,25h
916b1102 0f84dd010000    je      srv!ExecuteTransaction+0x29d (916b12e5)  Branch

srv!ExecuteTransaction+0xc0:
916b1108 3c26            cmp     al,26h
916b110a 0f84d5010000    je      srv!ExecuteTransaction+0x29d (916b12e5)  Branch

srv!ExecuteTransaction+0xc8:
916b1110 3ca0            cmp     al,0A0h
916b1112 0f8410010000    je      srv!ExecuteTransaction+0x1e0 (916b1228)  Branch

srv!ExecuteTransaction+0xd0:
916b1118 3ca1            cmp     al,0A1h
916b111a 0f8408010000    je      srv!ExecuteTransaction+0x1e0 (916b1228)  Branch

srv!ExecuteTransaction+0xd8:
916b1120 3c32            cmp     al,32h
916b1122 7408            je      srv!ExecuteTransaction+0xe4 (916b112c)  Branch

srv!ExecuteTransaction+0xdc:
916b1124 3c33            cmp     al,33h
916b1126 0f852b030000    jne     srv!ExecuteTransaction+0x40f (916b1457)  Branch

srv!ExecuteTransaction+0xe4:
916b112c 837e5001        cmp     dword ptr [esi+50h],1
916b1130 8b4638          mov     eax,dword ptr [esi+38h]
916b1133 0fb700          movzx   eax,word ptr [eax]
916b1136 7269            jb      srv!ExecuteTransaction+0x159 (916b11a1)  Branch

srv!ExecuteTransaction+0xf0:
916b1138 6683f811        cmp     ax,11h
916b113c 7763            ja      srv!ExecuteTransaction+0x159 (916b11a1)  Branch

srv!ExecuteTransaction+0xf6:
916b113e 0fb7c0          movzx   eax,ax
916b1141 57              push    edi
916b1142 ff148530156891  call    dword ptr srv!SrvTransaction2DispatchTable (91681530)[eax*4]
916b1149 8bd8            mov     ebx,eax
916b114b a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1150 80781d02        cmp     byte ptr [eax+1Dh],2
916b1154 0f82f8020000    jb      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x112:
916b115a f6402001        test    byte ptr [eax+20h],1
916b115e 0f84ee020000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x11c:
916b1164 ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b116a 3c02            cmp     al,2
916b116c 0f83e0020000    jae     srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x12a:
916b1172 85db            test    ebx,ebx
916b1174 0f84d8020000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x132:
916b117a a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b117f 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b1184 0f84c8020000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x142:
916b118a 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b118f 6a0c            push    0Ch

srv!ExecuteTransaction+0x149:
916b1191 ff7014          push    dword ptr [eax+14h]
916b1194 ff7010          push    dword ptr [eax+10h]
916b1197 e8e232fcff      call    srv!WPP_SF_ (9167447e)
916b119c e9b1020000      jmp     srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x159:
916b11a1 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b11a6 80781d02        cmp     byte ptr [eax+1Dh],2
916b11aa 725b            jb      srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x164:
916b11ac f6402001        test    byte ptr [eax+20h],1
916b11b0 7455            je      srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x16a:
916b11b2 ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b11b8 3c02            cmp     al,2
916b11ba 734b            jae     srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x174:
916b11bc 837e5000        cmp     dword ptr [esi+50h],0
916b11c0 7720            ja      srv!ExecuteTransaction+0x19a (916b11e2)  Branch

srv!ExecuteTransaction+0x17a:
916b11c2 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b11c7 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b11cc 7439            je      srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x186:
916b11ce 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b11d3 6a0d            push    0Dh
916b11d5 ff7014          push    dword ptr [eax+14h]
916b11d8 ff7010          push    dword ptr [eax+10h]
916b11db e89e32fcff      call    srv!WPP_SF_ (9167447e)
916b11e0 eb25            jmp     srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x19a:
916b11e2 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b11e7 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b11ec 7419            je      srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x1a6:
916b11ee 8b4e38          mov     ecx,dword ptr [esi+38h]
916b11f1 0fb709          movzx   ecx,word ptr [ecx]
916b11f4 51              push    ecx
916b11f5 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b11fa 6a0e            push    0Eh
916b11fc ff7014          push    dword ptr [eax+14h]
916b11ff ff7010          push    dword ptr [eax+10h]
916b1202 e8bc49fcff      call    srv!WPP_SF_q (91675bc3)

srv!ExecuteTransaction+0x1bf:
916b1207 68b3010000      push    1B3h
916b120c 57              push    edi
916b120d e8a6f8fdff      call    srv!SrvLogInvalidSmbDirect (91690ab8)
916b1212 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b1217 68b5010000      push    1B5h

srv!ExecuteTransaction+0x1d4:
916b121c 6a00            push    0
916b121e 68012098c0      push    0C0982001h
916b1223 e921020000      jmp     srv!ExecuteTransaction+0x401 (916b1449)  Branch

srv!ExecuteTransaction+0x1e0:
916b1228 0fb74672        movzx   eax,word ptr [esi+72h]
916b122c 8d48ff          lea     ecx,[eax-1]
916b122f 6683f908        cmp     cx,8
916b1233 7758            ja      srv!ExecuteTransaction+0x245 (916b128d)  Branch

srv!ExecuteTransaction+0x1ed:
916b1235 0fb7c0          movzx   eax,ax
916b1238 57              push    edi
916b1239 ff148578156891  call    dword ptr srv!SrvNtTransactionDispatchTable (91681578)[eax*4]
916b1240 8bd8            mov     ebx,eax
916b1242 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1247 80781d02        cmp     byte ptr [eax+1Dh],2
916b124b 0f8201020000    jb      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x209:
916b1251 f6402001        test    byte ptr [eax+20h],1
916b1255 0f84f7010000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x213:
916b125b ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b1261 3c02            cmp     al,2
916b1263 0f83e9010000    jae     srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x221:
916b1269 85db            test    ebx,ebx
916b126b 0f84e1010000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x229:
916b1271 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1276 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b127b 0f84d1010000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x239:
916b1281 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b1286 6a0a            push    0Ah
916b1288 e904ffffff      jmp     srv!ExecuteTransaction+0x149 (916b1191)  Branch

srv!ExecuteTransaction+0x245:
916b128d a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1292 80781d02        cmp     byte ptr [eax+1Dh],2
916b1296 7233            jb      srv!ExecuteTransaction+0x283 (916b12cb)  Branch

srv!ExecuteTransaction+0x250:
916b1298 f6402001        test    byte ptr [eax+20h],1
916b129c 742d            je      srv!ExecuteTransaction+0x283 (916b12cb)  Branch

srv!ExecuteTransaction+0x256:
916b129e ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b12a4 3c02            cmp     al,2
916b12a6 7323            jae     srv!ExecuteTransaction+0x283 (916b12cb)  Branch

srv!ExecuteTransaction+0x260:
916b12a8 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b12ad 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b12b2 7417            je      srv!ExecuteTransaction+0x283 (916b12cb)  Branch

srv!ExecuteTransaction+0x26c:
916b12b4 0fb74e72        movzx   ecx,word ptr [esi+72h]
916b12b8 51              push    ecx
916b12b9 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b12be 6a0b            push    0Bh
916b12c0 ff7014          push    dword ptr [eax+14h]
916b12c3 ff7010          push    dword ptr [eax+10h]
916b12c6 e8f848fcff      call    srv!WPP_SF_q (91675bc3)

srv!ExecuteTransaction+0x283:
916b12cb 6882010000      push    182h
916b12d0 57              push    edi
916b12d1 e8e2f7fdff      call    srv!SrvLogInvalidSmbDirect (91690ab8)
916b12d6 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b12db 6884010000      push    184h
916b12e0 e937ffffff      jmp     srv!ExecuteTransaction+0x1d4 (916b121c)  Branch

srv!ExecuteTransaction+0x29d:
916b12e5 80be9500000000  cmp     byte ptr [esi+95h],0
916b12ec 740b            je      srv!ExecuteTransaction+0x2b1 (916b12f9)  Branch

srv!ExecuteTransaction+0x2a6:
916b12ee 57              push    edi
916b12ef e83c4d0000      call    srv!SrvXsRequest (916b6030)
916b12f4 e93b010000      jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x2b1:
916b12f9 80be9400000000  cmp     byte ptr [esi+94h],0
916b1300 0f8410010000    je      srv!ExecuteTransaction+0x3ce (916b1416)  Branch

srv!ExecuteTransaction+0x2be:
916b1306 f6475401        test    byte ptr [edi+54h],1
916b130a 8b4638          mov     eax,dword ptr [esi+38h]
916b130d 0fb730          movzx   esi,word ptr [eax]
916b1310 754c            jne     srv!ExecuteTransaction+0x316 (916b135e)  Branch

srv!ExecuteTransaction+0x2ca:
916b1312 6683fe54        cmp     si,54h
916b1316 7412            je      srv!ExecuteTransaction+0x2e2 (916b132a)  Branch

srv!ExecuteTransaction+0x2d0:
916b1318 6683fe26        cmp     si,26h
916b131c 740c            je      srv!ExecuteTransaction+0x2e2 (916b132a)  Branch

srv!ExecuteTransaction+0x2d6:
916b131e 6683fe53        cmp     si,53h
916b1322 7406            je      srv!ExecuteTransaction+0x2e2 (916b132a)  Branch

srv!ExecuteTransaction+0x2dc:
916b1324 6683fe31        cmp     si,31h
916b1328 7534            jne     srv!ExecuteTransaction+0x316 (916b135e)  Branch

srv!ExecuteTransaction+0x2e2:
916b132a e889a9fcff      call    srv!SrvReceiveBufferShortage (9167bcb8)
916b132f 84c0            test    al,al
916b1331 7427            je      srv!ExecuteTransaction+0x312 (916b135a)  Branch

srv!ExecuteTransaction+0x2eb:
916b1333 a19c1f6891      mov     eax,dword ptr [srv!pSrvStatistics (91681f9c)]
916b1338 ff403c          inc     dword ptr [eax+3Ch]
916b133b 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b1340 68fe000000      push    0FEh
916b1345 6a00            push    0
916b1347 68050200c0      push    0C0000205h

srv!ExecuteTransaction+0x304:
916b134c 57              push    edi
916b134d e888460000      call    srv!_SrvSetSmbError2 (916b59da)
916b1352 6a02            push    2
916b1354 5b              pop     ebx
916b1355 e9fd000000      jmp     srv!ExecuteTransaction+0x40f (916b1457)  Branch

srv!ExecuteTransaction+0x312:
916b135a 834f5401        or      dword ptr [edi+54h],1

srv!ExecuteTransaction+0x316:
916b135e 0fb7c6          movzx   eax,si
916b1361 83f826          cmp     eax,26h
916b1364 7f59            jg      srv!ExecuteTransaction+0x377 (916b13bf)  Branch

srv!ExecuteTransaction+0x31e:
916b1366 744f            je      srv!ExecuteTransaction+0x36f (916b13b7)  Branch

srv!ExecuteTransaction+0x320:
916b1368 48              dec     eax
916b1369 7444            je      srv!ExecuteTransaction+0x367 (916b13af)  Branch

srv!ExecuteTransaction+0x323:
916b136b 83e810          sub     eax,10h
916b136e 742c            je      srv!ExecuteTransaction+0x354 (916b139c)  Branch

srv!ExecuteTransaction+0x328:
916b1370 83e810          sub     eax,10h
916b1373 741c            je      srv!ExecuteTransaction+0x349 (916b1391)  Branch

srv!ExecuteTransaction+0x32d:
916b1375 48              dec     eax
916b1376 740e            je      srv!ExecuteTransaction+0x33e (916b1386)  Branch

srv!ExecuteTransaction+0x330:
916b1378 48              dec     eax
916b1379 7554            jne     srv!ExecuteTransaction+0x387 (916b13cf)  Branch

srv!ExecuteTransaction+0x333:
916b137b 57              push    edi
916b137c e8ed77feff      call    srv!SrvPeekNamedPipe (91698b6e)
916b1381 e9ae000000      jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x33e:
916b1386 57              push    edi
916b1387 e8436afeff      call    srv!SrvQueryInformationNamedPipe (91697dcf)
916b138c e9a3000000      jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x349:
916b1391 57              push    edi
916b1392 e8ef67feff      call    srv!SrvQueryStateNamedPipe (91697b86)
916b1397 e998000000      jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x354:
916b139c 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b13a1 6830010000      push    130h
916b13a6 6a00            push    0
916b13a8 680d0000c0      push    0C000000Dh
916b13ad eb9d            jmp     srv!ExecuteTransaction+0x304 (916b134c)  Branch

srv!ExecuteTransaction+0x367:
916b13af 57              push    edi
916b13b0 e8106dfeff      call    srv!SrvSetStateNamedPipe (916980c5)
916b13b5 eb7d            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x36f:
916b13b7 57              push    edi
916b13b8 e8cd78feff      call    srv!SrvTransactNamedPipe (91698c8a)
916b13bd eb75            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x377:
916b13bf 83e836          sub     eax,36h
916b13c2 744a            je      srv!ExecuteTransaction+0x3c6 (916b140e)  Branch

srv!ExecuteTransaction+0x37c:
916b13c4 48              dec     eax
916b13c5 743f            je      srv!ExecuteTransaction+0x3be (916b1406)  Branch

srv!ExecuteTransaction+0x37f:
916b13c7 83e81c          sub     eax,1Ch
916b13ca 7432            je      srv!ExecuteTransaction+0x3b6 (916b13fe)  Branch

srv!ExecuteTransaction+0x384:
916b13cc 48              dec     eax
916b13cd 7427            je      srv!ExecuteTransaction+0x3ae (916b13f6)  Branch

srv!ExecuteTransaction+0x387:
916b13cf 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b13d4 683d010000      push    13Dh
916b13d9 6a00            push    0
916b13db 68012098c0      push    0C0982001h
916b13e0 57              push    edi
916b13e1 e8f4450000      call    srv!_SrvSetSmbError2 (916b59da)
916b13e6 6a02            push    2
916b13e8 5b              pop     ebx
916b13e9 6840010000      push    140h
916b13ee 57              push    edi
916b13ef e8c4f6fdff      call    srv!SrvLogInvalidSmbDirect (91690ab8)
916b13f4 eb61            jmp     srv!ExecuteTransaction+0x40f (916b1457)  Branch

srv!ExecuteTransaction+0x3ae:
916b13f6 57              push    edi
916b13f7 e83573feff      call    srv!SrvCallNamedPipe (91698731)
916b13fc eb36            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x3b6:
916b13fe 57              push    edi
916b13ff e85876feff      call    srv!SrvWaitNamedPipe (91698a5c)
916b1404 eb2e            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x3be:
916b1406 57              push    edi
916b1407 e8e179feff      call    srv!SrvWriteNamedPipe (91698ded)
916b140c eb26            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x3c6:
916b140e 57              push    edi
916b140f e8bc7bfeff      call    srv!SrvReadNamedPipe (91698fd0)
916b1414 eb1e            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x3ce:
916b1416 6a09            push    9
916b1418 ff35dc156891    push    dword ptr [srv!StrSlashMailslot (916815dc)]
916b141e ff7628          push    dword ptr [esi+28h]
916b1421 ff1590f26791    call    dword ptr [srv!_imp___wcsnicmp (9167f290)]
916b1427 83c40c          add     esp,0Ch
916b142a 85c0            test    eax,eax
916b142c 750a            jne     srv!ExecuteTransaction+0x3f0 (916b1438)  Branch

srv!ExecuteTransaction+0x3e6:
916b142e 57              push    edi
916b142f e893f9ffff      call    srv!MailslotTransaction (916b0dc7)

srv!ExecuteTransaction+0x3ec:
916b1434 8bd8            mov     ebx,eax
916b1436 eb1a            jmp     srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x3f0:
916b1438 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b143d 6856010000      push    156h
916b1442 6a00            push    0
916b1444 68020000c0      push    0C0000002h

srv!ExecuteTransaction+0x401:
916b1449 57              push    edi
916b144a e88b450000      call    srv!_SrvSetSmbError2 (916b59da)
916b144f 6a02            push    2
916b1451 5b              pop     ebx

srv!ExecuteTransaction+0x40a:
916b1452 83fb03          cmp     ebx,3
916b1455 7407            je      srv!ExecuteTransaction+0x416 (916b145e)  Branch

srv!ExecuteTransaction+0x40f:
916b1457 53              push    ebx
916b1458 57              push    edi
916b1459 e818f4ffff      call    srv!SrvCompleteExecuteTransaction (916b0876)

srv!ExecuteTransaction+0x416:
916b145e 6a03            push    3

srv!ExecuteTransaction+0x418:
916b1460 58              pop     eax
916b1461 5f              pop     edi
916b1462 5e              pop     esi
916b1463 5b              pop     ebx
916b1464 c3              ret
kd> uf srv!ExecuteTransaction+0x101
srv!ExecuteTransaction:
916b1048 8bff            mov     edi,edi
916b104a 53              push    ebx
916b104b 56              push    esi
916b104c 57              push    edi
916b104d 8bf9            mov     edi,ecx
916b104f 8a878c000000    mov     al,byte ptr [edi+8Ch]
916b1055 8bb7a0000000    mov     esi,dword ptr [edi+0A0h]
916b105b 884620          mov     byte ptr [esi+20h],al
916b105e 8a878c000000    mov     al,byte ptr [edi+8Ch]
916b1064 6a02            push    2
916b1066 5b              pop     ebx
916b1067 3c25            cmp     al,25h
916b1069 7404            je      srv!ExecuteTransaction+0x27 (916b106f)  Branch

srv!ExecuteTransaction+0x23:
916b106b 3c26            cmp     al,26h
916b106d 753f            jne     srv!ExecuteTransaction+0x66 (916b10ae)  Branch

srv!ExecuteTransaction+0x27:
916b106f 80be9500000000  cmp     byte ptr [esi+95h],0
916b1076 7436            je      srv!ExecuteTransaction+0x66 (916b10ae)  Branch

srv!ExecuteTransaction+0x30:
916b1078 807f1500        cmp     byte ptr [edi+15h],0
916b107c 7530            jne     srv!ExecuteTransaction+0x66 (916b10ae)  Branch

srv!ExecuteTransaction+0x36:
916b107e b201            mov     dl,1
916b1080 c7471848106b91  mov     dword ptr [edi+18h],offset srv!ExecuteTransaction (916b1048)
916b1087 e813c9fcff      call    srv!SrvQueueWorkToLpcThread (9167d99f)
916b108c 85c0            test    eax,eax
916b108e 0f8dca030000    jge     srv!ExecuteTransaction+0x416 (916b145e)  Branch

srv!ExecuteTransaction+0x4c:
916b1094 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b1099 689a000000      push    9Ah
916b109e 6a00            push    0
916b10a0 50              push    eax
916b10a1 57              push    edi
916b10a2 e833490000      call    srv!_SrvSetSmbError2 (916b59da)
916b10a7 6a02            push    2
916b10a9 e9b2030000      jmp     srv!ExecuteTransaction+0x418 (916b1460)  Branch

srv!ExecuteTransaction+0x66:
916b10ae 8b5778          mov     edx,dword ptr [edi+78h]
916b10b1 8b4f7c          mov     ecx,dword ptr [edi+7Ch]
916b10b4 3ca0            cmp     al,0A0h
916b10b6 7409            je      srv!ExecuteTransaction+0x79 (916b10c1)  Branch

srv!ExecuteTransaction+0x70:
916b10b8 3ca1            cmp     al,0A1h
916b10ba 7405            je      srv!ExecuteTransaction+0x79 (916b10c1)  Branch

srv!ExecuteTransaction+0x74:
916b10bc 83c115          add     ecx,15h
916b10bf eb03            jmp     srv!ExecuteTransaction+0x7c (916b10c4)  Branch

srv!ExecuteTransaction+0x79:
916b10c1 83c125          add     ecx,25h

srv!ExecuteTransaction+0x7c:
916b10c4 837e4400        cmp     dword ptr [esi+44h],0
916b10c8 894e3c          mov     dword ptr [esi+3Ch],ecx
916b10cb 7513            jne     srv!ExecuteTransaction+0x98 (916b10e0)  Branch

srv!ExecuteTransaction+0x85:
916b10cd 8b4654          mov     eax,dword ptr [esi+54h]
916b10d0 03c0            add     eax,eax
916b10d2 2bc2            sub     eax,edx
916b10d4 8d440803        lea     eax,[eax+ecx+3]
916b10d8 83e0fc          and     eax,0FFFFFFFCh
916b10db 03c2            add     eax,edx
916b10dd 894644          mov     dword ptr [esi+44h],eax

srv!ExecuteTransaction+0x98:
916b10e0 837e4c00        cmp     dword ptr [esi+4Ch],0
916b10e4 7514            jne     srv!ExecuteTransaction+0xb2 (916b10fa)  Branch

srv!ExecuteTransaction+0x9e:
916b10e6 8b4660          mov     eax,dword ptr [esi+60h]
916b10e9 8b4e44          mov     ecx,dword ptr [esi+44h]
916b10ec 2bc2            sub     eax,edx
916b10ee 8d440803        lea     eax,[eax+ecx+3]
916b10f2 83e0fc          and     eax,0FFFFFFFCh
916b10f5 03c2            add     eax,edx
916b10f7 89464c          mov     dword ptr [esi+4Ch],eax

srv!ExecuteTransaction+0xb2:
916b10fa 8a878c000000    mov     al,byte ptr [edi+8Ch]
916b1100 3c25            cmp     al,25h
916b1102 0f84dd010000    je      srv!ExecuteTransaction+0x29d (916b12e5)  Branch

srv!ExecuteTransaction+0xc0:
916b1108 3c26            cmp     al,26h
916b110a 0f84d5010000    je      srv!ExecuteTransaction+0x29d (916b12e5)  Branch

srv!ExecuteTransaction+0xc8:
916b1110 3ca0            cmp     al,0A0h
916b1112 0f8410010000    je      srv!ExecuteTransaction+0x1e0 (916b1228)  Branch

srv!ExecuteTransaction+0xd0:
916b1118 3ca1            cmp     al,0A1h
916b111a 0f8408010000    je      srv!ExecuteTransaction+0x1e0 (916b1228)  Branch

srv!ExecuteTransaction+0xd8:
916b1120 3c32            cmp     al,32h
916b1122 7408            je      srv!ExecuteTransaction+0xe4 (916b112c)  Branch

srv!ExecuteTransaction+0xdc:
916b1124 3c33            cmp     al,33h
916b1126 0f852b030000    jne     srv!ExecuteTransaction+0x40f (916b1457)  Branch

srv!ExecuteTransaction+0xe4:
916b112c 837e5001        cmp     dword ptr [esi+50h],1
916b1130 8b4638          mov     eax,dword ptr [esi+38h]
916b1133 0fb700          movzx   eax,word ptr [eax]
916b1136 7269            jb      srv!ExecuteTransaction+0x159 (916b11a1)  Branch

srv!ExecuteTransaction+0xf0:
916b1138 6683f811        cmp     ax,11h
916b113c 7763            ja      srv!ExecuteTransaction+0x159 (916b11a1)  Branch

srv!ExecuteTransaction+0xf6:
916b113e 0fb7c0          movzx   eax,ax
916b1141 57              push    edi
916b1142 ff148530156891  call    dword ptr srv!SrvTransaction2DispatchTable (91681530)[eax*4]
916b1149 8bd8            mov     ebx,eax
916b114b a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1150 80781d02        cmp     byte ptr [eax+1Dh],2
916b1154 0f82f8020000    jb      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x112:
916b115a f6402001        test    byte ptr [eax+20h],1
916b115e 0f84ee020000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x11c:
916b1164 ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b116a 3c02            cmp     al,2
916b116c 0f83e0020000    jae     srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x12a:
916b1172 85db            test    ebx,ebx
916b1174 0f84d8020000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x132:
916b117a a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b117f 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b1184 0f84c8020000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x142:
916b118a 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b118f 6a0c            push    0Ch

srv!ExecuteTransaction+0x149:
916b1191 ff7014          push    dword ptr [eax+14h]
916b1194 ff7010          push    dword ptr [eax+10h]
916b1197 e8e232fcff      call    srv!WPP_SF_ (9167447e)
916b119c e9b1020000      jmp     srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x159:
916b11a1 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b11a6 80781d02        cmp     byte ptr [eax+1Dh],2
916b11aa 725b            jb      srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x164:
916b11ac f6402001        test    byte ptr [eax+20h],1
916b11b0 7455            je      srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x16a:
916b11b2 ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b11b8 3c02            cmp     al,2
916b11ba 734b            jae     srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x174:
916b11bc 837e5000        cmp     dword ptr [esi+50h],0
916b11c0 7720            ja      srv!ExecuteTransaction+0x19a (916b11e2)  Branch

srv!ExecuteTransaction+0x17a:
916b11c2 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b11c7 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b11cc 7439            je      srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x186:
916b11ce 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b11d3 6a0d            push    0Dh
916b11d5 ff7014          push    dword ptr [eax+14h]
916b11d8 ff7010          push    dword ptr [eax+10h]
916b11db e89e32fcff      call    srv!WPP_SF_ (9167447e)
916b11e0 eb25            jmp     srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x19a:
916b11e2 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b11e7 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b11ec 7419            je      srv!ExecuteTransaction+0x1bf (916b1207)  Branch

srv!ExecuteTransaction+0x1a6:
916b11ee 8b4e38          mov     ecx,dword ptr [esi+38h]
916b11f1 0fb709          movzx   ecx,word ptr [ecx]
916b11f4 51              push    ecx
916b11f5 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b11fa 6a0e            push    0Eh
916b11fc ff7014          push    dword ptr [eax+14h]
916b11ff ff7010          push    dword ptr [eax+10h]
916b1202 e8bc49fcff      call    srv!WPP_SF_q (91675bc3)

srv!ExecuteTransaction+0x1bf:
916b1207 68b3010000      push    1B3h
916b120c 57              push    edi
916b120d e8a6f8fdff      call    srv!SrvLogInvalidSmbDirect (91690ab8)
916b1212 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b1217 68b5010000      push    1B5h

srv!ExecuteTransaction+0x1d4:
916b121c 6a00            push    0
916b121e 68012098c0      push    0C0982001h
916b1223 e921020000      jmp     srv!ExecuteTransaction+0x401 (916b1449)  Branch

srv!ExecuteTransaction+0x1e0:
916b1228 0fb74672        movzx   eax,word ptr [esi+72h]
916b122c 8d48ff          lea     ecx,[eax-1]
916b122f 6683f908        cmp     cx,8
916b1233 7758            ja      srv!ExecuteTransaction+0x245 (916b128d)  Branch

srv!ExecuteTransaction+0x1ed:
916b1235 0fb7c0          movzx   eax,ax
916b1238 57              push    edi
916b1239 ff148578156891  call    dword ptr srv!SrvNtTransactionDispatchTable (91681578)[eax*4]
916b1240 8bd8            mov     ebx,eax
916b1242 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1247 80781d02        cmp     byte ptr [eax+1Dh],2
916b124b 0f8201020000    jb      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x209:
916b1251 f6402001        test    byte ptr [eax+20h],1
916b1255 0f84f7010000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x213:
916b125b ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b1261 3c02            cmp     al,2
916b1263 0f83e9010000    jae     srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x221:
916b1269 85db            test    ebx,ebx
916b126b 0f84e1010000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x229:
916b1271 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1276 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b127b 0f84d1010000    je      srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x239:
916b1281 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b1286 6a0a            push    0Ah
916b1288 e904ffffff      jmp     srv!ExecuteTransaction+0x149 (916b1191)  Branch

srv!ExecuteTransaction+0x245:
916b128d a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1292 80781d02        cmp     byte ptr [eax+1Dh],2
916b1296 7233            jb      srv!ExecuteTransaction+0x283 (916b12cb)  Branch

srv!ExecuteTransaction+0x250:
916b1298 f6402001        test    byte ptr [eax+20h],1
916b129c 742d            je      srv!ExecuteTransaction+0x283 (916b12cb)  Branch

srv!ExecuteTransaction+0x256:
916b129e ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b12a4 3c02            cmp     al,2
916b12a6 7323            jae     srv!ExecuteTransaction+0x283 (916b12cb)  Branch

srv!ExecuteTransaction+0x260:
916b12a8 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b12ad 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b12b2 7417            je      srv!ExecuteTransaction+0x283 (916b12cb)  Branch

srv!ExecuteTransaction+0x26c:
916b12b4 0fb74e72        movzx   ecx,word ptr [esi+72h]
916b12b8 51              push    ecx
916b12b9 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b12be 6a0b            push    0Bh
916b12c0 ff7014          push    dword ptr [eax+14h]
916b12c3 ff7010          push    dword ptr [eax+10h]
916b12c6 e8f848fcff      call    srv!WPP_SF_q (91675bc3)

srv!ExecuteTransaction+0x283:
916b12cb 6882010000      push    182h
916b12d0 57              push    edi
916b12d1 e8e2f7fdff      call    srv!SrvLogInvalidSmbDirect (91690ab8)
916b12d6 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b12db 6884010000      push    184h
916b12e0 e937ffffff      jmp     srv!ExecuteTransaction+0x1d4 (916b121c)  Branch

srv!ExecuteTransaction+0x29d:
916b12e5 80be9500000000  cmp     byte ptr [esi+95h],0
916b12ec 740b            je      srv!ExecuteTransaction+0x2b1 (916b12f9)  Branch

srv!ExecuteTransaction+0x2a6:
916b12ee 57              push    edi
916b12ef e83c4d0000      call    srv!SrvXsRequest (916b6030)
916b12f4 e93b010000      jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x2b1:
916b12f9 80be9400000000  cmp     byte ptr [esi+94h],0
916b1300 0f8410010000    je      srv!ExecuteTransaction+0x3ce (916b1416)  Branch

srv!ExecuteTransaction+0x2be:
916b1306 f6475401        test    byte ptr [edi+54h],1
916b130a 8b4638          mov     eax,dword ptr [esi+38h]
916b130d 0fb730          movzx   esi,word ptr [eax]
916b1310 754c            jne     srv!ExecuteTransaction+0x316 (916b135e)  Branch

srv!ExecuteTransaction+0x2ca:
916b1312 6683fe54        cmp     si,54h
916b1316 7412            je      srv!ExecuteTransaction+0x2e2 (916b132a)  Branch

srv!ExecuteTransaction+0x2d0:
916b1318 6683fe26        cmp     si,26h
916b131c 740c            je      srv!ExecuteTransaction+0x2e2 (916b132a)  Branch

srv!ExecuteTransaction+0x2d6:
916b131e 6683fe53        cmp     si,53h
916b1322 7406            je      srv!ExecuteTransaction+0x2e2 (916b132a)  Branch

srv!ExecuteTransaction+0x2dc:
916b1324 6683fe31        cmp     si,31h
916b1328 7534            jne     srv!ExecuteTransaction+0x316 (916b135e)  Branch

srv!ExecuteTransaction+0x2e2:
916b132a e889a9fcff      call    srv!SrvReceiveBufferShortage (9167bcb8)
916b132f 84c0            test    al,al
916b1331 7427            je      srv!ExecuteTransaction+0x312 (916b135a)  Branch

srv!ExecuteTransaction+0x2eb:
916b1333 a19c1f6891      mov     eax,dword ptr [srv!pSrvStatistics (91681f9c)]
916b1338 ff403c          inc     dword ptr [eax+3Ch]
916b133b 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b1340 68fe000000      push    0FEh
916b1345 6a00            push    0
916b1347 68050200c0      push    0C0000205h

srv!ExecuteTransaction+0x304:
916b134c 57              push    edi
916b134d e888460000      call    srv!_SrvSetSmbError2 (916b59da)
916b1352 6a02            push    2
916b1354 5b              pop     ebx
916b1355 e9fd000000      jmp     srv!ExecuteTransaction+0x40f (916b1457)  Branch

srv!ExecuteTransaction+0x312:
916b135a 834f5401        or      dword ptr [edi+54h],1

srv!ExecuteTransaction+0x316:
916b135e 0fb7c6          movzx   eax,si
916b1361 83f826          cmp     eax,26h
916b1364 7f59            jg      srv!ExecuteTransaction+0x377 (916b13bf)  Branch

srv!ExecuteTransaction+0x31e:
916b1366 744f            je      srv!ExecuteTransaction+0x36f (916b13b7)  Branch

srv!ExecuteTransaction+0x320:
916b1368 48              dec     eax
916b1369 7444            je      srv!ExecuteTransaction+0x367 (916b13af)  Branch

srv!ExecuteTransaction+0x323:
916b136b 83e810          sub     eax,10h
916b136e 742c            je      srv!ExecuteTransaction+0x354 (916b139c)  Branch

srv!ExecuteTransaction+0x328:
916b1370 83e810          sub     eax,10h
916b1373 741c            je      srv!ExecuteTransaction+0x349 (916b1391)  Branch

srv!ExecuteTransaction+0x32d:
916b1375 48              dec     eax
916b1376 740e            je      srv!ExecuteTransaction+0x33e (916b1386)  Branch

srv!ExecuteTransaction+0x330:
916b1378 48              dec     eax
916b1379 7554            jne     srv!ExecuteTransaction+0x387 (916b13cf)  Branch

srv!ExecuteTransaction+0x333:
916b137b 57              push    edi
916b137c e8ed77feff      call    srv!SrvPeekNamedPipe (91698b6e)
916b1381 e9ae000000      jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x33e:
916b1386 57              push    edi
916b1387 e8436afeff      call    srv!SrvQueryInformationNamedPipe (91697dcf)
916b138c e9a3000000      jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x349:
916b1391 57              push    edi
916b1392 e8ef67feff      call    srv!SrvQueryStateNamedPipe (91697b86)
916b1397 e998000000      jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x354:
916b139c 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b13a1 6830010000      push    130h
916b13a6 6a00            push    0
916b13a8 680d0000c0      push    0C000000Dh
916b13ad eb9d            jmp     srv!ExecuteTransaction+0x304 (916b134c)  Branch

srv!ExecuteTransaction+0x367:
916b13af 57              push    edi
916b13b0 e8106dfeff      call    srv!SrvSetStateNamedPipe (916980c5)
916b13b5 eb7d            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x36f:
916b13b7 57              push    edi
916b13b8 e8cd78feff      call    srv!SrvTransactNamedPipe (91698c8a)
916b13bd eb75            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x377:
916b13bf 83e836          sub     eax,36h
916b13c2 744a            je      srv!ExecuteTransaction+0x3c6 (916b140e)  Branch

srv!ExecuteTransaction+0x37c:
916b13c4 48              dec     eax
916b13c5 743f            je      srv!ExecuteTransaction+0x3be (916b1406)  Branch

srv!ExecuteTransaction+0x37f:
916b13c7 83e81c          sub     eax,1Ch
916b13ca 7432            je      srv!ExecuteTransaction+0x3b6 (916b13fe)  Branch

srv!ExecuteTransaction+0x384:
916b13cc 48              dec     eax
916b13cd 7427            je      srv!ExecuteTransaction+0x3ae (916b13f6)  Branch

srv!ExecuteTransaction+0x387:
916b13cf 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b13d4 683d010000      push    13Dh
916b13d9 6a00            push    0
916b13db 68012098c0      push    0C0982001h
916b13e0 57              push    edi
916b13e1 e8f4450000      call    srv!_SrvSetSmbError2 (916b59da)
916b13e6 6a02            push    2
916b13e8 5b              pop     ebx
916b13e9 6840010000      push    140h
916b13ee 57              push    edi
916b13ef e8c4f6fdff      call    srv!SrvLogInvalidSmbDirect (91690ab8)
916b13f4 eb61            jmp     srv!ExecuteTransaction+0x40f (916b1457)  Branch

srv!ExecuteTransaction+0x3ae:
916b13f6 57              push    edi
916b13f7 e83573feff      call    srv!SrvCallNamedPipe (91698731)
916b13fc eb36            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x3b6:
916b13fe 57              push    edi
916b13ff e85876feff      call    srv!SrvWaitNamedPipe (91698a5c)
916b1404 eb2e            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x3be:
916b1406 57              push    edi
916b1407 e8e179feff      call    srv!SrvWriteNamedPipe (91698ded)
916b140c eb26            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x3c6:
916b140e 57              push    edi
916b140f e8bc7bfeff      call    srv!SrvReadNamedPipe (91698fd0)
916b1414 eb1e            jmp     srv!ExecuteTransaction+0x3ec (916b1434)  Branch

srv!ExecuteTransaction+0x3ce:
916b1416 6a09            push    9
916b1418 ff35dc156891    push    dword ptr [srv!StrSlashMailslot (916815dc)]
916b141e ff7628          push    dword ptr [esi+28h]
916b1421 ff1590f26791    call    dword ptr [srv!_imp___wcsnicmp (9167f290)]
916b1427 83c40c          add     esp,0Ch
916b142a 85c0            test    eax,eax
916b142c 750a            jne     srv!ExecuteTransaction+0x3f0 (916b1438)  Branch

srv!ExecuteTransaction+0x3e6:
916b142e 57              push    edi
916b142f e893f9ffff      call    srv!MailslotTransaction (916b0dc7)

srv!ExecuteTransaction+0x3ec:
916b1434 8bd8            mov     ebx,eax
916b1436 eb1a            jmp     srv!ExecuteTransaction+0x40a (916b1452)  Branch

srv!ExecuteTransaction+0x3f0:
916b1438 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b143d 6856010000      push    156h
916b1442 6a00            push    0
916b1444 68020000c0      push    0C0000002h

srv!ExecuteTransaction+0x401:
916b1449 57              push    edi
916b144a e88b450000      call    srv!_SrvSetSmbError2 (916b59da)
916b144f 6a02            push    2
916b1451 5b              pop     ebx

srv!ExecuteTransaction+0x40a:
916b1452 83fb03          cmp     ebx,3
916b1455 7407            je      srv!ExecuteTransaction+0x416 (916b145e)  Branch

srv!ExecuteTransaction+0x40f:
916b1457 53              push    ebx
916b1458 57              push    edi
916b1459 e818f4ffff      call    srv!SrvCompleteExecuteTransaction (916b0876)

srv!ExecuteTransaction+0x416:
916b145e 6a03            push    3

srv!ExecuteTransaction+0x418:
916b1460 58              pop     eax
916b1461 5f              pop     edi
916b1462 5e              pop     esi
916b1463 5b              pop     ebx
916b1464 c3              ret
kd> kv
 # ChildEBP RetAddr  Args to Child              
00 88af65fc 8271c083 00000003 012648da 00000065 nt!RtlpBreakWithStatusInstruction (FPO: [1,0,0])
01 88af664c 8271cb81 00000003 83f28020 0000188c nt!KiBugCheckDebugBreak+0x1c
02 88af6a10 826cb41b 00000050 95ed6000 00000000 nt!KeBugCheck2+0x68b
03 88af6a9c 8267e3d8 00000000 95ed6000 00000000 nt!MmAccessFault+0x106
04 88af6a9c 82676b90 00000000 95ed6000 00000000 nt!KiTrap0E+0xdc (FPO: [0,0] TrapFrame @ 88af6ab4)
05 88af6b30 9169027e 83fc801d 95ed10e9 0000cc00 nt!memmove+0x90
06 88af6b5c 91690603 83fc8014 95ed10e4 83e7a008 srv!SrvOs2FeaToNt+0x53 (FPO: [Non-Fpo])
07 88af6b7c 916a9602 83fc8014 88af6bbc 88af6ba8 srv!SrvOs2FeaListToNt+0x9e (FPO: [Non-Fpo])
08 88af6bb4 916b1149 83fbc008 82676b00 95ec5008 srv!SrvSmbOpen2+0x93 (FPO: [Non-Fpo])
09 88af6bc8 916b21b8 9167f6ec 83e7a008 91681000 srv!ExecuteTransaction+0x101 (FPO: [0,0,4])
0a 88af6c00 9167b496 83e7a008 8549c058 8549c020 srv!SrvSmbTransactionSecondary+0x2c5 (FPO: [Non-Fpo])
0b 88af6c28 9168a922 00000000 83f28020 00000000 srv!SrvProcessSmb+0x187 (FPO: [Non-Fpo])
0c 88af6c50 82846f5e 0049c020 01264206 00000000 srv!WorkerThread+0x15c (FPO: [Non-Fpo])
0d 88af6c90 826ee219 9168a7c6 8549c020 00000000 nt!PspSystemThreadStartup+0x9e
0e 00000000 00000000 00000000 00000000 00000000 nt!KiThreadStartup+0x19
kd> uf srv!SrvSmbTransactionSecondary+0x2c5
srv!SrvSmbTransactionSecondary:
916b1ef3 8bff            mov     edi,edi
916b1ef5 55              push    ebp
916b1ef6 8bec            mov     ebp,esp
916b1ef8 83ec24          sub     esp,24h
916b1efb a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1f00 80781d02        cmp     byte ptr [eax+1Dh],2
916b1f04 53              push    ebx
916b1f05 8bd9            mov     ebx,ecx
916b1f07 56              push    esi
916b1f08 8b7370          mov     esi,dword ptr [ebx+70h]
916b1f0b 57              push    edi
916b1f0c 8b7b74          mov     edi,dword ptr [ebx+74h]
916b1f0f 8975e8          mov     dword ptr [ebp-18h],esi
916b1f12 7242            jb      srv!SrvSmbTransactionSecondary+0x63 (916b1f56)  Branch

srv!SrvSmbTransactionSecondary+0x21:
916b1f14 f6402001        test    byte ptr [eax+20h],1
916b1f18 743c            je      srv!SrvSmbTransactionSecondary+0x63 (916b1f56)  Branch

srv!SrvSmbTransactionSecondary+0x27:
916b1f1a ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b1f20 3c02            cmp     al,2
916b1f22 7332            jae     srv!SrvSmbTransactionSecondary+0x63 (916b1f56)  Branch

srv!SrvSmbTransactionSecondary+0x31:
916b1f24 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1f29 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b1f2e 7426            je      srv!SrvSmbTransactionSecondary+0x63 (916b1f56)  Branch

srv!SrvSmbTransactionSecondary+0x3d:
916b1f30 80bb8c00000026  cmp     byte ptr [ebx+8Ch],26h
916b1f37 b9a2546891      mov     ecx,offset srv! ?? ::NNGAKEGL::`string' (916854a2)
916b1f3c 7405            je      srv!SrvSmbTransactionSecondary+0x50 (916b1f43)  Branch

srv!SrvSmbTransactionSecondary+0x4b:
916b1f3e b9f6586891      mov     ecx,offset srv! ?? ::NNGAKEGL::`string' (916858f6)

srv!SrvSmbTransactionSecondary+0x50:
916b1f43 51              push    ecx
916b1f44 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b1f49 6a2b            push    2Bh
916b1f4b ff7014          push    dword ptr [eax+14h]
916b1f4e ff7010          push    dword ptr [eax+10h]
916b1f51 e86d49fcff      call    srv!WPP_SF_s (916768c3)

srv!SrvSmbTransactionSecondary+0x63:
916b1f56 8b434c          mov     eax,dword ptr [ebx+4Ch]
916b1f59 6a00            push    0
916b1f5b 56              push    esi
916b1f5c 50              push    eax
916b1f5d 8945f4          mov     dword ptr [ebp-0Ch],eax
916b1f60 e88ae4ffff      call    srv!SrvFindTransaction (916b03ef)
916b1f65 8bf0            mov     esi,eax
916b1f67 85f6            test    esi,esi
916b1f69 7541            jne     srv!SrvSmbTransactionSecondary+0xb9 (916b1fac)  Branch

srv!SrvSmbTransactionSecondary+0x78:
916b1f6b a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1f70 80781d02        cmp     byte ptr [eax+1Dh],2
916b1f74 722e            jb      srv!SrvSmbTransactionSecondary+0xb1 (916b1fa4)  Branch

srv!SrvSmbTransactionSecondary+0x83:
916b1f76 f6402001        test    byte ptr [eax+20h],1
916b1f7a 7428            je      srv!SrvSmbTransactionSecondary+0xb1 (916b1fa4)  Branch

srv!SrvSmbTransactionSecondary+0x89:
916b1f7c ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b1f82 3c02            cmp     al,2
916b1f84 731e            jae     srv!SrvSmbTransactionSecondary+0xb1 (916b1fa4)  Branch

srv!SrvSmbTransactionSecondary+0x93:
916b1f86 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b1f8b 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b1f90 7412            je      srv!SrvSmbTransactionSecondary+0xb1 (916b1fa4)  Branch

srv!SrvSmbTransactionSecondary+0x9f:
916b1f92 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b1f97 6a2c            push    2Ch
916b1f99 ff7014          push    dword ptr [eax+14h]
916b1f9c ff7010          push    dword ptr [eax+10h]
916b1f9f e8da24fcff      call    srv!WPP_SF_ (9167447e)

srv!SrvSmbTransactionSecondary+0xb1:
916b1fa4 6a02            push    2
916b1fa6 58              pop     eax
916b1fa7 e9e0020000      jmp     srv!SrvSmbTransactionSecondary+0x399 (916b228c)  Branch

srv!SrvSmbTransactionSecondary+0xb9:
916b1fac 8b4610          mov     eax,dword ptr [esi+10h]
916b1faf 80b89a00000000  cmp     byte ptr [eax+9Ah],0
916b1fb6 7416            je      srv!SrvSmbTransactionSecondary+0xdb (916b1fce)  Branch

srv!SrvSmbTransactionSecondary+0xc5:
916b1fb8 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b1fbd 68d8090000      push    9D8h
916b1fc2 6a00            push    0
916b1fc4 685c0300c0      push    0C000035Ch
916b1fc9 e9b5020000      jmp     srv!SrvSmbTransactionSecondary+0x390 (916b2283)  Branch

srv!SrvSmbTransactionSecondary+0xdb:
916b1fce 0fb75709        movzx   edx,word ptr [edi+9]
916b1fd2 0fb74f07        movzx   ecx,word ptr [edi+7]
916b1fd6 0fb74705        movzx   eax,word ptr [edi+5]
916b1fda 8955ec          mov     dword ptr [ebp-14h],edx
916b1fdd 0fb7570d        movzx   edx,word ptr [edi+0Dh]
916b1fe1 8955f0          mov     dword ptr [ebp-10h],edx
916b1fe4 0fb7570b        movzx   edx,word ptr [edi+0Bh]
916b1fe8 0fb77f0f        movzx   edi,word ptr [edi+0Fh]
916b1fec 897de4          mov     dword ptr [ebp-1Ch],edi
916b1fef 8b7b68          mov     edi,dword ptr [ebx+68h]
916b1ff2 8b7f10          mov     edi,dword ptr [edi+10h]
916b1ff5 894de0          mov     dword ptr [ebp-20h],ecx
916b1ff8 03c8            add     ecx,eax
916b1ffa 8945f8          mov     dword ptr [ebp-8],eax
916b1ffd 8955fc          mov     dword ptr [ebp-4],edx
916b2000 897ddc          mov     dword ptr [ebp-24h],edi
916b2003 3bcf            cmp     ecx,edi
916b2005 0f87fe010000    ja      srv!SrvSmbTransactionSecondary+0x316 (916b2209)  Branch

srv!SrvSmbTransactionSecondary+0x118:
916b200b 8b4df0          mov     ecx,dword ptr [ebp-10h]
916b200e 03ca            add     ecx,edx
916b2010 3bcf            cmp     ecx,edi
916b2012 0f87f1010000    ja      srv!SrvSmbTransactionSecondary+0x316 (916b2209)  Branch

srv!SrvSmbTransactionSecondary+0x125:
916b2018 8b4dec          mov     ecx,dword ptr [ebp-14h]
916b201b 03c8            add     ecx,eax
916b201d 3b4e5c          cmp     ecx,dword ptr [esi+5Ch]
916b2020 0f87e3010000    ja      srv!SrvSmbTransactionSecondary+0x316 (916b2209)  Branch

srv!SrvSmbTransactionSecondary+0x133:
916b2026 8b45e4          mov     eax,dword ptr [ebp-1Ch]
916b2029 03c2            add     eax,edx
916b202b 3b4668          cmp     eax,dword ptr [esi+68h]
916b202e 0f87d5010000    ja      srv!SrvSmbTransactionSecondary+0x316 (916b2209)  Branch

srv!SrvSmbTransactionSecondary+0x141:
916b2034 8b7df4          mov     edi,dword ptr [ebp-0Ch]
916b2037 81c79c010000    add     edi,19Ch
916b203d 6a01            push    1
916b203f 57              push    edi
916b2040 897df4          mov     dword ptr [ebp-0Ch],edi
916b2043 ff1544f36791    call    dword ptr [srv!_imp__ExAcquireResourceExclusiveLite (9167f344)]
916b2049 80be9700000001  cmp     byte ptr [esi+97h],1
916b2050 7556            jne     srv!SrvSmbTransactionSecondary+0x1b5 (916b20a8)  Branch

srv!SrvSmbTransactionSecondary+0x15f:
916b2052 8bcf            mov     ecx,edi
916b2054 ff15f4f26791    call    dword ptr [srv!_imp_ExReleaseResourceLite (9167f2f4)]
916b205a a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b205f 80781d02        cmp     byte ptr [eax+1Dh],2
916b2063 0f8203020000    jb      srv!SrvSmbTransactionSecondary+0x379 (916b226c)  Branch

srv!SrvSmbTransactionSecondary+0x176:
916b2069 f6402001        test    byte ptr [eax+20h],1
916b206d 0f84f9010000    je      srv!SrvSmbTransactionSecondary+0x379 (916b226c)  Branch

srv!SrvSmbTransactionSecondary+0x180:
916b2073 ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b2079 3c02            cmp     al,2
916b207b 0f83eb010000    jae     srv!SrvSmbTransactionSecondary+0x379 (916b226c)  Branch

srv!SrvSmbTransactionSecondary+0x18e:
916b2081 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b2086 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b208b 0f84db010000    je      srv!SrvSmbTransactionSecondary+0x379 (916b226c)  Branch

srv!SrvSmbTransactionSecondary+0x19e:
916b2091 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b2096 6a2f            push    2Fh
916b2098 ff7014          push    dword ptr [eax+14h]
916b209b ff7010          push    dword ptr [eax+10h]
916b209e e8db23fcff      call    srv!WPP_SF_ (9167447e)
916b20a3 e9c4010000      jmp     srv!SrvSmbTransactionSecondary+0x379 (916b226c)  Branch

srv!SrvSmbTransactionSecondary+0x1b5:
916b20a8 837df800        cmp     dword ptr [ebp-8],0
916b20ac 8b3de0f06791    mov     edi,dword ptr [srv!_imp__memmove (9167f0e0)]
916b20b2 7418            je      srv!SrvSmbTransactionSecondary+0x1d9 (916b20cc)  Branch

srv!SrvSmbTransactionSecondary+0x1c1:
916b20b4 8b4de8          mov     ecx,dword ptr [ebp-18h]
916b20b7 ff75f8          push    dword ptr [ebp-8]
916b20ba 8b45e0          mov     eax,dword ptr [ebp-20h]
916b20bd 03c1            add     eax,ecx
916b20bf 50              push    eax
916b20c0 8b4640          mov     eax,dword ptr [esi+40h]
916b20c3 0345ec          add     eax,dword ptr [ebp-14h]
916b20c6 50              push    eax
916b20c7 ffd7            call    edi
916b20c9 83c40c          add     esp,0Ch

srv!SrvSmbTransactionSecondary+0x1d9:
916b20cc 837dfc00        cmp     dword ptr [ebp-4],0
916b20d0 7418            je      srv!SrvSmbTransactionSecondary+0x1f7 (916b20ea)  Branch

srv!SrvSmbTransactionSecondary+0x1df:
916b20d2 8b4de8          mov     ecx,dword ptr [ebp-18h]
916b20d5 ff75fc          push    dword ptr [ebp-4]
916b20d8 8b45f0          mov     eax,dword ptr [ebp-10h]
916b20db 03c1            add     eax,ecx
916b20dd 50              push    eax
916b20de 8b4648          mov     eax,dword ptr [esi+48h]
916b20e1 0345e4          add     eax,dword ptr [ebp-1Ch]
916b20e4 50              push    eax
916b20e5 ffd7            call    edi
916b20e7 83c40c          add     esp,0Ch

srv!SrvSmbTransactionSecondary+0x1f7:
916b20ea 807e0102        cmp     byte ptr [esi+1],2
916b20ee 744d            je      srv!SrvSmbTransactionSecondary+0x24a (916b213d)  Branch

srv!SrvSmbTransactionSecondary+0x1fd:
916b20f0 8b4df4          mov     ecx,dword ptr [ebp-0Ch]
916b20f3 ff15f4f26791    call    dword ptr [srv!_imp_ExReleaseResourceLite (9167f2f4)]
916b20f9 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b20fe 80781d02        cmp     byte ptr [eax+1Dh],2
916b2102 722e            jb      srv!SrvSmbTransactionSecondary+0x23f (916b2132)  Branch

srv!SrvSmbTransactionSecondary+0x211:
916b2104 f6402001        test    byte ptr [eax+20h],1
916b2108 7428            je      srv!SrvSmbTransactionSecondary+0x23f (916b2132)  Branch

srv!SrvSmbTransactionSecondary+0x217:
916b210a ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b2110 3c02            cmp     al,2
916b2112 731e            jae     srv!SrvSmbTransactionSecondary+0x23f (916b2132)  Branch

srv!SrvSmbTransactionSecondary+0x221:
916b2114 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b2119 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b211e 7412            je      srv!SrvSmbTransactionSecondary+0x23f (916b2132)  Branch

srv!SrvSmbTransactionSecondary+0x22d:
916b2120 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b2125 6a30            push    30h

srv!SrvSmbTransactionSecondary+0x234:
916b2127 ff7014          push    dword ptr [eax+14h]
916b212a ff7010          push    dword ptr [eax+10h]
916b212d e84c23fcff      call    srv!WPP_SF_ (9167447e)

srv!SrvSmbTransactionSecondary+0x23f:
916b2132 56              push    esi
916b2133 e833d0fdff      call    srv!SrvDereferenceTransaction (9168f16b)
916b2138 e967feffff      jmp     srv!SrvSmbTransactionSecondary+0xb1 (916b1fa4)  Branch

srv!SrvSmbTransactionSecondary+0x24a:
916b213d 8b45f8          mov     eax,dword ptr [ebp-8]
916b2140 014658          add     dword ptr [esi+58h],eax
916b2143 8b45fc          mov     eax,dword ptr [ebp-4]
916b2146 014664          add     dword ptr [esi+64h],eax
916b2149 8b4664          mov     eax,dword ptr [esi+64h]
916b214c 8b4e58          mov     ecx,dword ptr [esi+58h]
916b214f 3b4668          cmp     eax,dword ptr [esi+68h]
916b2152 7569            jne     srv!SrvSmbTransactionSecondary+0x2ca (916b21bd)  Branch

srv!SrvSmbTransactionSecondary+0x261:
916b2154 3b4e5c          cmp     ecx,dword ptr [esi+5Ch]
916b2157 7564            jne     srv!SrvSmbTransactionSecondary+0x2ca (916b21bd)  Branch

srv!SrvSmbTransactionSecondary+0x266:
916b2159 8b4610          mov     eax,dword ptr [esi+10h]
916b215c 89433c          mov     dword ptr [ebx+3Ch],eax
916b215f 8b4610          mov     eax,dword ptr [esi+10h]
916b2162 8b4008          mov     eax,dword ptr [eax+8]
916b2165 33c9            xor     ecx,ecx
916b2167 83c004          add     eax,4
916b216a 41              inc     ecx
916b216b f00fc108        lock xadd dword ptr [eax],ecx
916b216f 8b433c          mov     eax,dword ptr [ebx+3Ch]
916b2172 8b8080000000    mov     eax,dword ptr [eax+80h]
916b2178 85c0            test    eax,eax
916b217a 7409            je      srv!SrvSmbTransactionSecondary+0x292 (916b2185)  Branch

srv!SrvSmbTransactionSecondary+0x289:
916b217c 50              push    eax
916b217d 894344          mov     dword ptr [ebx+44h],eax
916b2180 e83bbafdff      call    srv!SrvReferenceSecurityContext (9168dbc0)

srv!SrvSmbTransactionSecondary+0x292:
916b2185 8b4614          mov     eax,dword ptr [esi+14h]
916b2188 894340          mov     dword ptr [ebx+40h],eax
916b218b 8b4614          mov     eax,dword ptr [esi+14h]
916b218e 8b4008          mov     eax,dword ptr [eax+8]
916b2191 33c9            xor     ecx,ecx
916b2193 83c004          add     eax,4
916b2196 41              inc     ecx
916b2197 f00fc108        lock xadd dword ptr [eax],ecx
916b219b 8b4df4          mov     ecx,dword ptr [ebp-0Ch]
916b219e c6869700000001  mov     byte ptr [esi+97h],1
916b21a5 ff15f4f26791    call    dword ptr [srv!_imp_ExReleaseResourceLite (9167f2f4)]
916b21ab 8bcb            mov     ecx,ebx
916b21ad 89b3a0000000    mov     dword ptr [ebx+0A0h],esi
916b21b3 e890eeffff      call    srv!ExecuteTransaction (916b1048)
916b21b8 e9cf000000      jmp     srv!SrvSmbTransactionSecondary+0x399 (916b228c)  Branch

srv!SrvSmbTransactionSecondary+0x2ca:
916b21bd 8b4df4          mov     ecx,dword ptr [ebp-0Ch]
916b21c0 ff15f4f26791    call    dword ptr [srv!_imp_ExReleaseResourceLite (9167f2f4)]
916b21c6 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b21cb 80781d02        cmp     byte ptr [eax+1Dh],2
916b21cf 0f825dffffff    jb      srv!SrvSmbTransactionSecondary+0x23f (916b2132)  Branch

srv!SrvSmbTransactionSecondary+0x2e2:
916b21d5 f6402001        test    byte ptr [eax+20h],1
916b21d9 0f8453ffffff    je      srv!SrvSmbTransactionSecondary+0x23f (916b2132)  Branch

srv!SrvSmbTransactionSecondary+0x2ec:
916b21df ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b21e5 3c02            cmp     al,2
916b21e7 0f8345ffffff    jae     srv!SrvSmbTransactionSecondary+0x23f (916b2132)  Branch

srv!SrvSmbTransactionSecondary+0x2fa:
916b21ed a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b21f2 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b21f7 0f8435ffffff    je      srv!SrvSmbTransactionSecondary+0x23f (916b2132)  Branch

srv!SrvSmbTransactionSecondary+0x30a:
916b21fd 682cf76791      push    offset srv!`string'+0xc0 (9167f72c)
916b2202 6a31            push    31h
916b2204 e91effffff      jmp     srv!SrvSmbTransactionSecondary+0x234 (916b2127)  Branch

srv!SrvSmbTransactionSecondary+0x316:
916b2209 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b220e 80781d02        cmp     byte ptr [eax+1Dh],2
916b2212 7258            jb      srv!SrvSmbTransactionSecondary+0x379 (916b226c)  Branch

srv!SrvSmbTransactionSecondary+0x321:
916b2214 f6402001        test    byte ptr [eax+20h],1
916b2218 7452            je      srv!SrvSmbTransactionSecondary+0x379 (916b226c)  Branch

srv!SrvSmbTransactionSecondary+0x327:
916b221a ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
916b2220 3c02            cmp     al,2
916b2222 7348            jae     srv!SrvSmbTransactionSecondary+0x379 (916b226c)  Branch

srv!SrvSmbTransactionSecondary+0x331:
916b2224 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b2229 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b222e 743c            je      srv!SrvSmbTransactionSecondary+0x379 (916b226c)  Branch

srv!SrvSmbTransactionSecondary+0x33d:
916b2230 ff75fc          push    dword ptr [ebp-4]
916b2233 bf2cf76791      mov     edi,offset srv!`string'+0xc0 (9167f72c)
916b2238 ff75f0          push    dword ptr [ebp-10h]
916b223b ff75f8          push    dword ptr [ebp-8]
916b223e ff75e0          push    dword ptr [ebp-20h]
916b2241 57              push    edi
916b2242 6a2d            push    2Dh
916b2244 ff7014          push    dword ptr [eax+14h]
916b2247 ff7010          push    dword ptr [eax+10h]
916b224a e892b6fcff      call    srv!WPP_SF_qdDD (9167d8e1)
916b224f a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
916b2254 3d00106891      cmp     eax,offset srv!WPP_GLOBAL_Control (91681000)
916b2259 7411            je      srv!SrvSmbTransactionSecondary+0x379 (916b226c)  Branch

srv!SrvSmbTransactionSecondary+0x368:
916b225b ff75dc          push    dword ptr [ebp-24h]
916b225e 57              push    edi
916b225f 6a2e            push    2Eh
916b2261 ff7014          push    dword ptr [eax+14h]
916b2264 ff7010          push    dword ptr [eax+10h]
916b2267 e85739fcff      call    srv!WPP_SF_q (91675bc3)

srv!SrvSmbTransactionSecondary+0x379:
916b226c 56              push    esi
916b226d e8f9cefdff      call    srv!SrvDereferenceTransaction (9168f16b)
916b2272 6882586891      push    offset srv! ?? ::NNGAKEGL::`string' (91685882)
916b2277 689a0a0000      push    0A9Ah
916b227c 6a00            push    0
916b227e 68012098c0      push    0C0982001h

srv!SrvSmbTransactionSecondary+0x390:
916b2283 53              push    ebx
916b2284 e851370000      call    srv!_SrvSetSmbError2 (916b59da)
916b2289 33c0            xor     eax,eax
916b228b 40              inc     eax

srv!SrvSmbTransactionSecondary+0x399:
916b228c 5f              pop     edi
916b228d 5e              pop     esi
916b228e 5b              pop     ebx
916b228f c9              leave
916b2290 c3              ret
kd> kv
 # ChildEBP RetAddr  Args to Child              
00 88af65fc 8271c083 00000003 012648da 00000065 nt!RtlpBreakWithStatusInstruction (FPO: [1,0,0])
01 88af664c 8271cb81 00000003 83f28020 0000188c nt!KiBugCheckDebugBreak+0x1c
02 88af6a10 826cb41b 00000050 95ed6000 00000000 nt!KeBugCheck2+0x68b
03 88af6a9c 8267e3d8 00000000 95ed6000 00000000 nt!MmAccessFault+0x106
04 88af6a9c 82676b90 00000000 95ed6000 00000000 nt!KiTrap0E+0xdc (FPO: [0,0] TrapFrame @ 88af6ab4)
05 88af6b30 9169027e 83fc801d 95ed10e9 0000cc00 nt!memmove+0x90
06 88af6b5c 91690603 83fc8014 95ed10e4 83e7a008 srv!SrvOs2FeaToNt+0x53 (FPO: [Non-Fpo])
07 88af6b7c 916a9602 83fc8014 88af6bbc 88af6ba8 srv!SrvOs2FeaListToNt+0x9e (FPO: [Non-Fpo])
08 88af6bb4 916b1149 83fbc008 82676b00 95ec5008 srv!SrvSmbOpen2+0x93 (FPO: [Non-Fpo])
09 88af6bc8 916b21b8 9167f6ec 83e7a008 91681000 srv!ExecuteTransaction+0x101 (FPO: [0,0,4])
0a 88af6c00 9167b496 83e7a008 8549c058 8549c020 srv!SrvSmbTransactionSecondary+0x2c5 (FPO: [Non-Fpo])
0b 88af6c28 9168a922 00000000 83f28020 00000000 srv!SrvProcessSmb+0x187 (FPO: [Non-Fpo])
0c 88af6c50 82846f5e 0049c020 01264206 00000000 srv!WorkerThread+0x15c (FPO: [Non-Fpo])
0d 88af6c90 826ee219 9168a7c6 8549c020 00000000 nt!PspSystemThreadStartup+0x9e
0e 00000000 00000000 00000000 00000000 00000000 nt!KiThreadStartup+0x19
kd> uf srv!SrvProcessSmb+0x187
srv!SrvProcessSmb:
9167b30f 8bff            mov     edi,edi
9167b311 55              push    ebp
9167b312 8bec            mov     ebp,esp
9167b314 83ec14          sub     esp,14h
9167b317 56              push    esi
9167b318 8bf1            mov     esi,ecx
9167b31a 8b464c          mov     eax,dword ptr [esi+4Ch]
9167b31d 80786e00        cmp     byte ptr [eax+6Eh],0
9167b321 7505            jne     srv!SrvProcessSmb+0x19 (9167b328)  Branch

srv!SrvProcessSmb+0x14:
9167b323 e862990100      call    srv!SrvInitializeConnection (91694c8a)

srv!SrvProcessSmb+0x19:
9167b328 837e5001        cmp     dword ptr [esi+50h],1
9167b32c 7538            jne     srv!SrvProcessSmb+0x57 (9167b366)  Branch

srv!SrvProcessSmb+0x1f:
9167b32e 8b464c          mov     eax,dword ptr [esi+4Ch]
9167b331 80786f00        cmp     byte ptr [eax+6Fh],0
9167b335 742f            je      srv!SrvProcessSmb+0x57 (9167b366)  Branch

srv!SrvProcessSmb+0x28:
9167b337 8bce            mov     ecx,esi
9167b339 e81093ffff      call    srv!SrvCheckSmbSecuritySignature (9167464e)
9167b33e 84c0            test    al,al
9167b340 7524            jne     srv!SrvProcessSmb+0x57 (9167b366)  Branch

srv!SrvProcessSmb+0x33:
9167b342 6806ea6791      push    offset srv! ?? ::FNODOBFM::`string' (9167ea06)
9167b347 68df000000      push    0DFh
9167b34c 6a00            push    0
9167b34e 68220000c0      push    0C0000022h
9167b353 56              push    esi
9167b354 e881a60300      call    srv!_SrvSetSmbError2 (916b59da)
9167b359 6a01            push    1
9167b35b 56              push    esi
9167b35c e863ffffff      call    srv!SrvEndSmbProcessing (9167b2c4)
9167b361 e9a5010000      jmp     srv!SrvProcessSmb+0x1fc (9167b50b)  Branch

srv!SrvProcessSmb+0x57:
9167b366 837e5001        cmp     dword ptr [esi+50h],1
9167b36a 53              push    ebx
9167b36b 57              push    edi
9167b36c bfecf66791      mov     edi,offset srv!`string'+0x80 (9167f6ec)
9167b371 bb00106891      mov     ebx,offset srv!WPP_GLOBAL_Control (91681000)
9167b376 0f8594000000    jne     srv!SrvProcessSmb+0x101 (9167b410)  Branch

srv!SrvProcessSmb+0x6d:
9167b37c a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
9167b381 f6402008        test    byte ptr [eax+20h],8
9167b385 0f8485000000    je      srv!SrvProcessSmb+0x101 (9167b410)  Branch

srv!SrvProcessSmb+0x7c:
9167b38b 8b4670          mov     eax,dword ptr [esi+70h]
9167b38e 0fb7481c        movzx   ecx,word ptr [eax+1Ch]
9167b392 894df8          mov     dword ptr [ebp-8],ecx
9167b395 0fb74818        movzx   ecx,word ptr [eax+18h]
9167b399 894df0          mov     dword ptr [ebp-10h],ecx
9167b39c 0fb7481e        movzx   ecx,word ptr [eax+1Eh]
9167b3a0 894dfc          mov     dword ptr [ebp-4],ecx
9167b3a3 0fb7481a        movzx   ecx,word ptr [eax+1Ah]
9167b3a7 660fb64004      movzx   ax,byte ptr [eax+4]
9167b3ac 0fb7c0          movzx   eax,ax
9167b3af 8945ec          mov     dword ptr [ebp-14h],eax
9167b3b2 a180f16791      mov     eax,dword ptr [srv!KeTickCount (9167f180)]
9167b3b7 894df4          mov     dword ptr [ebp-0Ch],ecx
9167b3ba eb02            jmp     srv!SrvProcessSmb+0xaf (9167b3be)  Branch

srv!SrvProcessSmb+0xad:
9167b3bc f390            pause

srv!SrvProcessSmb+0xaf:
9167b3be 8b5004          mov     edx,dword ptr [eax+4]
9167b3c1 8b08            mov     ecx,dword ptr [eax]
9167b3c3 8b5808          mov     ebx,dword ptr [eax+8]
9167b3c6 3bd3            cmp     edx,ebx
9167b3c8 75f2            jne     srv!SrvProcessSmb+0xad (9167b3bc)  Branch

srv!SrvProcessSmb+0xbb:
9167b3ca a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
9167b3cf bb00106891      mov     ebx,offset srv!WPP_GLOBAL_Control (91681000)
9167b3d4 3bc3            cmp     eax,ebx
9167b3d6 7438            je      srv!SrvProcessSmb+0x101 (9167b410)  Branch

srv!SrvProcessSmb+0xc9:
9167b3d8 0fb755fc        movzx   edx,word ptr [ebp-4]
9167b3dc 52              push    edx
9167b3dd 0fb755f8        movzx   edx,word ptr [ebp-8]
9167b3e1 52              push    edx
9167b3e2 0fb755f4        movzx   edx,word ptr [ebp-0Ch]
9167b3e6 52              push    edx
9167b3e7 0fb755f0        movzx   edx,word ptr [ebp-10h]
9167b3eb 52              push    edx
9167b3ec 0fb755ec        movzx   edx,word ptr [ebp-14h]
9167b3f0 52              push    edx
9167b3f1 8b5668          mov     edx,dword ptr [esi+68h]
9167b3f4 56              push    esi
9167b3f5 ffb680000000    push    dword ptr [esi+80h]
9167b3fb ff7670          push    dword ptr [esi+70h]
9167b3fe ff7210          push    dword ptr [edx+10h]
9167b401 51              push    ecx
9167b402 57              push    edi
9167b403 6a0e            push    0Eh
9167b405 ff7014          push    dword ptr [eax+14h]
9167b408 ff7010          push    dword ptr [eax+10h]
9167b40b e858feffff      call    srv!WPP_SF_ddqqqDDDDD (9167b268)

srv!SrvProcessSmb+0x101:
9167b410 660fb68e8c000000 movzx   cx,byte ptr [esi+8Ch]
9167b418 66a1d8116891    mov     ax,word ptr [srv!SessionInvalidateCommand (916811d8)]
9167b41e 663bc8          cmp     cx,ax
9167b421 740a            je      srv!SrvProcessSmb+0x11e (9167b42d)  Branch

srv!SrvProcessSmb+0x114:
9167b423 b900ff0000      mov     ecx,0FF00h
9167b428 663bc1          cmp     ax,cx
9167b42b 7552            jne     srv!SrvProcessSmb+0x170 (9167b47f)  Branch

srv!SrvProcessSmb+0x11e:
9167b42d 0fb70518196891  movzx   eax,word ptr [srv!SessionInvalidateIndex (91681918)]
9167b434 0fb70ddc116891  movzx   ecx,word ptr [srv!SessionInvalidateMod (916811dc)]
9167b43b 99              cdq
9167b43c f7f9            idiv    eax,ecx
9167b43e 66ff0518196891  inc     word ptr [srv!SessionInvalidateIndex (91681918)]
9167b445 85d2            test    edx,edx
9167b447 7536            jne     srv!SrvProcessSmb+0x170 (9167b47f)  Branch

srv!SrvProcessSmb+0x13a:
9167b449 8b4670          mov     eax,dword ptr [esi+70h]
9167b44c 0fb7401c        movzx   eax,word ptr [eax+1Ch]
9167b450 50              push    eax
9167b451 56              push    esi
9167b452 e86c340300      call    srv!SrvVerifyUid (916ae8c3)
9167b457 8b463c          mov     eax,dword ptr [esi+3Ch]
9167b45a 85c0            test    eax,eax
9167b45c 7421            je      srv!SrvProcessSmb+0x170 (9167b47f)  Branch

srv!SrvProcessSmb+0x14f:
9167b45e c6809a00000001  mov     byte ptr [eax+9Ah],1
9167b465 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
9167b46a 3bc3            cmp     eax,ebx
9167b46c 7411            je      srv!SrvProcessSmb+0x170 (9167b47f)  Branch

srv!SrvProcessSmb+0x15f:
9167b46e ff763c          push    dword ptr [esi+3Ch]
9167b471 57              push    edi
9167b472 6a0f            push    0Fh
9167b474 ff7014          push    dword ptr [eax+14h]
9167b477 ff7010          push    dword ptr [eax+10h]
9167b47a e844a7ffff      call    srv!WPP_SF_q (91675bc3)

srv!SrvProcessSmb+0x170:
9167b47f 0fb6868c000000  movzx   eax,byte ptr [esi+8Ch]
9167b486 0fb68068126891  movzx   eax,byte ptr srv!SrvSmbIndexTable (91681268)[eax]
9167b48d 8bce            mov     ecx,esi
9167b48f ff148568136891  call    dword ptr srv!SrvSmbDispatchTable (91681368)[eax*4]
9167b496 83f803          cmp     eax,3
9167b499 746e            je      srv!SrvProcessSmb+0x1fa (9167b509)  Branch

srv!SrvProcessSmb+0x18c:
9167b49b 85c0            test    eax,eax
9167b49d 756f            jne     srv!SrvProcessSmb+0x1ff (9167b50e)  Branch

srv!SrvProcessSmb+0x190:
9167b49f 8bce            mov     ecx,esi
9167b4a1 e8bf0f0000      call    srv!SrvValidateSmb (9167c465)
9167b4a6 84c0            test    al,al
9167b4a8 0f8562ffffff    jne     srv!SrvProcessSmb+0x101 (9167b410)  Branch

srv!SrvProcessSmb+0x19f:
9167b4ae a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
9167b4b3 80781d02        cmp     byte ptr [eax+1Dh],2
9167b4b7 7248            jb      srv!SrvProcessSmb+0x1f2 (9167b501)  Branch

srv!SrvProcessSmb+0x1aa:
9167b4b9 f6402001        test    byte ptr [eax+20h],1
9167b4bd 7442            je      srv!SrvProcessSmb+0x1f2 (9167b501)  Branch

srv!SrvProcessSmb+0x1b0:
9167b4bf ff1570f36791    call    dword ptr [srv!_imp__KeGetCurrentIrql (9167f370)]
9167b4c5 3c02            cmp     al,2
9167b4c7 7338            jae     srv!SrvProcessSmb+0x1f2 (9167b501)  Branch

srv!SrvProcessSmb+0x1ba:
9167b4c9 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
9167b4ce 3bc3            cmp     eax,ebx
9167b4d0 742f            je      srv!SrvProcessSmb+0x1f2 (9167b501)  Branch

srv!SrvProcessSmb+0x1c3:
9167b4d2 57              push    edi
9167b4d3 6a15            push    15h
9167b4d5 ff7014          push    dword ptr [eax+14h]
9167b4d8 ff7010          push    dword ptr [eax+10h]
9167b4db e89e8fffff      call    srv!WPP_SF_ (9167447e)
9167b4e0 a100106891      mov     eax,dword ptr [srv!WPP_GLOBAL_Control (91681000)]
9167b4e5 3bc3            cmp     eax,ebx
9167b4e7 7418            je      srv!SrvProcessSmb+0x1f2 (9167b501)  Branch

srv!SrvProcessSmb+0x1da:
9167b4e9 8b4e4c          mov     ecx,dword ptr [esi+4Ch]
9167b4ec 81c10c020000    add     ecx,20Ch
9167b4f2 51              push    ecx
9167b4f3 57              push    edi
9167b4f4 6a16            push    16h
9167b4f6 ff7014          push    dword ptr [eax+14h]
9167b4f9 ff7010          push    dword ptr [eax+10h]
9167b4fc e839e0ffff      call    srv!WPP_SF_z (9167953a)

srv!SrvProcessSmb+0x1f2:
9167b501 6a01            push    1

srv!SrvProcessSmb+0x1f4:
9167b503 56              push    esi
9167b504 e8bbfdffff      call    srv!SrvEndSmbProcessing (9167b2c4)

srv!SrvProcessSmb+0x1fa:
9167b509 5f              pop     edi
9167b50a 5b              pop     ebx

srv!SrvProcessSmb+0x1fc:
9167b50b 5e              pop     esi
9167b50c c9              leave
9167b50d c3              ret

srv!SrvProcessSmb+0x1ff:
9167b50e 50              push    eax
9167b50f ebf2            jmp     srv!SrvProcessSmb+0x1f4 (9167b503)  Branch
kd> kv
 # ChildEBP RetAddr  Args to Child              
00 88af65fc 8271c083 00000003 012648da 00000065 nt!RtlpBreakWithStatusInstruction (FPO: [1,0,0])
01 88af664c 8271cb81 00000003 83f28020 0000188c nt!KiBugCheckDebugBreak+0x1c
02 88af6a10 826cb41b 00000050 95ed6000 00000000 nt!KeBugCheck2+0x68b
03 88af6a9c 8267e3d8 00000000 95ed6000 00000000 nt!MmAccessFault+0x106
04 88af6a9c 82676b90 00000000 95ed6000 00000000 nt!KiTrap0E+0xdc (FPO: [0,0] TrapFrame @ 88af6ab4)
05 88af6b30 9169027e 83fc801d 95ed10e9 0000cc00 nt!memmove+0x90
06 88af6b5c 91690603 83fc8014 95ed10e4 83e7a008 srv!SrvOs2FeaToNt+0x53 (FPO: [Non-Fpo])
07 88af6b7c 916a9602 83fc8014 88af6bbc 88af6ba8 srv!SrvOs2FeaListToNt+0x9e (FPO: [Non-Fpo])
08 88af6bb4 916b1149 83fbc008 82676b00 95ec5008 srv!SrvSmbOpen2+0x93 (FPO: [Non-Fpo])
09 88af6bc8 916b21b8 9167f6ec 83e7a008 91681000 srv!ExecuteTransaction+0x101 (FPO: [0,0,4])
0a 88af6c00 9167b496 83e7a008 8549c058 8549c020 srv!SrvSmbTransactionSecondary+0x2c5 (FPO: [Non-Fpo])
0b 88af6c28 9168a922 00000000 83f28020 00000000 srv!SrvProcessSmb+0x187 (FPO: [Non-Fpo])
0c 88af6c50 82846f5e 0049c020 01264206 00000000 srv!WorkerThread+0x15c (FPO: [Non-Fpo])
0d 88af6c90 826ee219 9168a7c6 8549c020 00000000 nt!PspSystemThreadStartup+0x9e
0e 00000000 00000000 00000000 00000000 00000000 nt!KiThreadStartup+0x19
kd> uf  srv!WorkerThread+0x15c 
srv!WorkerThread:
9168a7c6 8bff            mov     edi,edi
9168a7c8 55              push    ebp
9168a7c9 8bec            mov     ebp,esp
9168a7cb 83ec14          sub     esp,14h
9168a7ce 53              push    ebx
9168a7cf 56              push    esi
9168a7d0 8b7508          mov     esi,dword ptr [ebp+8]
9168a7d3 33c0            xor     eax,eax
9168a7d5 57              push    edi
9168a7d6 8945f4          mov     dword ptr [ebp-0Ch],eax
9168a7d9 8945f8          mov     dword ptr [ebp-8],eax
9168a7dc 3b35e01e6891    cmp     esi,dword ptr [srv!SrvBlockingWorkQueues (91681ee0)]
9168a7e2 720c            jb      srv!WorkerThread+0x2a (9168a7f0)  Branch

srv!WorkerThread+0x1e:
9168a7e4 c6450b01        mov     byte ptr [ebp+0Bh],1
9168a7e8 3b35e41e6891    cmp     esi,dword ptr [srv!eSrvBlockingWorkQueues (91681ee4)]
9168a7ee 7203            jb      srv!WorkerThread+0x2d (9168a7f3)  Branch

srv!WorkerThread+0x2a:
9168a7f0 88450b          mov     byte ptr [ebp+0Bh],al

srv!WorkerThread+0x2d:
9168a7f3 8b3d2cf06791    mov     edi,dword ptr [srv!_imp__KeGetCurrentThread (9167f02c)]
9168a7f9 81fe881a6891    cmp     esi,offset srv!SrvLpcWorkQueue (91681a88)
9168a7ff 0f9445ff        sete    byte ptr [ebp-1]
9168a803 8945f0          mov     dword ptr [ebp-10h],eax
9168a806 398604010000    cmp     dword ptr [esi+104h],eax
9168a80c 7508            jne     srv!WorkerThread+0x50 (9168a816)  Branch

srv!WorkerThread+0x48:
9168a80e ffd7            call    edi
9168a810 898604010000    mov     dword ptr [esi+104h],eax

srv!WorkerThread+0x50:
9168a816 ff35c4196891    push    dword ptr [srv!SrvThreadPriority (916819c4)]
9168a81c 56              push    esi
9168a81d e816010000      call    srv!InitializeWorkerThread (9168a938)
9168a822 ffd7            call    edi
9168a824 398604010000    cmp     dword ptr [esi+104h],eax
9168a82a 7406            je      srv!WorkerThread+0x6c (9168a832)  Branch

srv!WorkerThread+0x66:
9168a82c 8d4630          lea     eax,[esi+30h]
9168a82f 8945f0          mov     dword ptr [ebp-10h],eax

srv!WorkerThread+0x6c:
9168a832 8d5e38          lea     ebx,[esi+38h]

srv!WorkerThread+0x6f:
9168a835 0fb606          movzx   eax,byte ptr [esi]
9168a838 ff75f0          push    dword ptr [ebp-10h]
9168a83b 50              push    eax
9168a83c 8d4604          lea     eax,[esi+4]
9168a83f 50              push    eax
9168a840 ff15e8f26791    call    dword ptr [srv!_imp__KeRemoveQueue (9167f2e8)]
9168a846 8bf8            mov     edi,eax
9168a848 81ff02010000    cmp     edi,102h
9168a84e 751d            jne     srv!WorkerThread+0xa7 (9168a86d)  Branch

srv!WorkerThread+0x8a:
9168a850 8bc3            mov     eax,ebx
9168a852 83c9ff          or      ecx,0FFFFFFFFh
9168a855 f00fc108        lock xadd dword ptr [eax],ecx
9168a859 8d86f8000000    lea     eax,[esi+0F8h]
9168a85f 83c9ff          or      ecx,0FFFFFFFFh
9168a862 f00fc108        lock xadd dword ptr [eax],ecx
9168a866 33c9            xor     ecx,ecx
9168a868 e84132ffff      call    srv!SrvTerminateWorkerThread (9167daae)

srv!WorkerThread+0xa7:
9168a86d 83c8ff          or      eax,0FFFFFFFFh
9168a870 f00fc103        lock xadd dword ptr [ebx],eax
9168a874 751d            jne     srv!WorkerThread+0xcd (9168a893)  Branch

srv!WorkerThread+0xb0:
9168a876 803dcd1c689100  cmp     byte ptr [srv!SrvFspTransitioning (91681ccd)],0
9168a87d 7514            jne     srv!WorkerThread+0xcd (9168a893)  Branch

srv!WorkerThread+0xb9:
9168a87f 8b86f8000000    mov     eax,dword ptr [esi+0F8h]
9168a885 3b86fc000000    cmp     eax,dword ptr [esi+0FCh]
9168a88b 7306            jae     srv!WorkerThread+0xcd (9168a893)  Branch

srv!WorkerThread+0xc7:
9168a88d 56              push    esi
9168a88e e856feffff      call    srv!CreateQueueThread (9168a6e9)

srv!WorkerThread+0xcd:
9168a893 83c7f8          add     edi,0FFFFFFF8h
9168a896 ff45f8          inc     dword ptr [ebp-8]
9168a899 837df810        cmp     dword ptr [ebp-8],10h
9168a89d 751f            jne     srv!WorkerThread+0xf8 (9168a8be)  Branch

srv!WorkerThread+0xd9:
9168a89f 8365f800        and     dword ptr [ebp-8],0
9168a8a3 a180f16791      mov     eax,dword ptr [srv!KeTickCount (9167f180)]
9168a8a8 eb02            jmp     srv!WorkerThread+0xe6 (9168a8ac)  Branch

srv!WorkerThread+0xe4:
9168a8aa f390            pause

srv!WorkerThread+0xe6:
9168a8ac 8b5004          mov     edx,dword ptr [eax+4]
9168a8af 8b08            mov     ecx,dword ptr [eax]
9168a8b1 8b5808          mov     ebx,dword ptr [eax+8]
9168a8b4 3bd3            cmp     edx,ebx
9168a8b6 75f2            jne     srv!WorkerThread+0xe4 (9168a8aa)  Branch

srv!WorkerThread+0xf2:
9168a8b8 898ed8010000    mov     dword ptr [esi+1D8h],ecx

srv!WorkerThread+0xf8:
9168a8be ff45f4          inc     dword ptr [ebp-0Ch]
9168a8c1 837df410        cmp     dword ptr [ebp-0Ch],10h
9168a8c5 740e            je      srv!WorkerThread+0x10f (9168a8d5)  Branch

srv!WorkerThread+0x101:
9168a8c7 8b86d0010000    mov     eax,dword ptr [esi+1D0h]
9168a8cd 3b86e0010000    cmp     eax,dword ptr [esi+1E0h]
9168a8d3 7539            jne     srv!WorkerThread+0x148 (9168a90e)  Branch

srv!WorkerThread+0x10f:
9168a8d5 8b9ed8010000    mov     ebx,dword ptr [esi+1D8h]
9168a8db 8b86d0010000    mov     eax,dword ptr [esi+1D0h]
9168a8e1 8365f400        and     dword ptr [ebp-0Ch],0
9168a8e5 2b5f10          sub     ebx,dword ptr [edi+10h]
9168a8e8 3b86e0010000    cmp     eax,dword ptr [esi+1E0h]
9168a8ee 750c            jne     srv!WorkerThread+0x136 (9168a8fc)  Branch

srv!WorkerThread+0x12a:
9168a8f0 6a01            push    1
9168a8f2 68c02d6891      push    offset srv!SrvIdleLogic (91682dc0)
9168a8f7 e8af38ffff      call    srv!SrvLibMarkServerAsNotIdle (9167e1ab)

srv!WorkerThread+0x136:
9168a8fc ff86d0010000    inc     dword ptr [esi+1D0h]
9168a902 8d86c8010000    lea     eax,[esi+1C8h]
9168a908 0118            add     dword ptr [eax],ebx
9168a90a 83500400        adc     dword ptr [eax+4],0

srv!WorkerThread+0x148:
9168a90e 8a450b          mov     al,byte ptr [ebp+0Bh]
9168a911 884714          mov     byte ptr [edi+14h],al
9168a914 8a45ff          mov     al,byte ptr [ebp-1]
9168a917 8bcf            mov     ecx,edi
9168a919 897dec          mov     dword ptr [ebp-14h],edi
9168a91c 884715          mov     byte ptr [edi+15h],al
9168a91f ff5718          call    dword ptr [edi+18h]
9168a922 8d5e38          lea     ebx,[esi+38h]
9168a925 33c9            xor     ecx,ecx
9168a927 8bc3            mov     eax,ebx
9168a929 41              inc     ecx
9168a92a f00fc108        lock xadd dword ptr [eax],ecx
9168a92e e902ffffff      jmp     srv!WorkerThread+0x6f (9168a835)  Branch
kd> kv
 # ChildEBP RetAddr  Args to Child              
00 88af65fc 8271c083 00000003 012648da 00000065 nt!RtlpBreakWithStatusInstruction (FPO: [1,0,0])
01 88af664c 8271cb81 00000003 83f28020 0000188c nt!KiBugCheckDebugBreak+0x1c
02 88af6a10 826cb41b 00000050 95ed6000 00000000 nt!KeBugCheck2+0x68b
03 88af6a9c 8267e3d8 00000000 95ed6000 00000000 nt!MmAccessFault+0x106
04 88af6a9c 82676b90 00000000 95ed6000 00000000 nt!KiTrap0E+0xdc (FPO: [0,0] TrapFrame @ 88af6ab4)
05 88af6b30 9169027e 83fc801d 95ed10e9 0000cc00 nt!memmove+0x90
06 88af6b5c 91690603 83fc8014 95ed10e4 83e7a008 srv!SrvOs2FeaToNt+0x53 (FPO: [Non-Fpo])
07 88af6b7c 916a9602 83fc8014 88af6bbc 88af6ba8 srv!SrvOs2FeaListToNt+0x9e (FPO: [Non-Fpo])
08 88af6bb4 916b1149 83fbc008 82676b00 95ec5008 srv!SrvSmbOpen2+0x93 (FPO: [Non-Fpo])
09 88af6bc8 916b21b8 9167f6ec 83e7a008 91681000 srv!ExecuteTransaction+0x101 (FPO: [0,0,4])
0a 88af6c00 9167b496 83e7a008 8549c058 8549c020 srv!SrvSmbTransactionSecondary+0x2c5 (FPO: [Non-Fpo])
0b 88af6c28 9168a922 00000000 83f28020 00000000 srv!SrvProcessSmb+0x187 (FPO: [Non-Fpo])
0c 88af6c50 82846f5e 0049c020 01264206 00000000 srv!WorkerThread+0x15c (FPO: [Non-Fpo])
0d 88af6c90 826ee219 9168a7c6 8549c020 00000000 nt!PspSystemThreadStartup+0x9e
0e 00000000 00000000 00000000 00000000 00000000 nt!KiThreadStartup+0x19
